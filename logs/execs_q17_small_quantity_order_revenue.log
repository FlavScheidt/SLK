Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121741_1881160480.txt
OK
Time taken: 3.452 seconds
OK
Time taken: 0.064 seconds
OK
Time taken: 0.01 seconds
OK
Time taken: 0.007 seconds
OK
Time taken: 0.234 seconds
OK
Time taken: 0.033 seconds
FAILED: Error in metadata: MetaException(message:Got exception: org.apache.hadoop.ipc.RemoteException org.apache.hadoop.hdfs.server.namenode.SafeModeException: Cannot create directory /user/hive/warehouse/q17_small_quantity_order_revenue. Name node is in safe mode.
The ratio of reported blocks 1.0000 has reached the threshold 0.9990. Safe mode will be turned off automatically in 24 seconds.
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.mkdirsInternal(FSNamesystem.java:1761)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.mkdirs(FSNamesystem.java:1735)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.mkdirs(NameNode.java:542)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:508)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:959)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:955)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:953)
)
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121741_499479715.txt
OK
Time taken: 3.604 seconds
OK
Time taken: 0.064 seconds
OK
Time taken: 0.009 seconds
OK
Time taken: 0.007 seconds
OK
Time taken: 0.243 seconds
OK
Time taken: 0.033 seconds
OK
Time taken: 0.033 seconds
OK
Time taken: 0.05 seconds
Total MapReduce jobs = 1
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 8
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121741_0001, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121741_0001
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121741_0001
2016-04-12 17:41:50,342 Stage-1 map = 0%,  reduce = 0%
2016-04-12 17:41:59,410 Stage-1 map = 1%,  reduce = 0%
2016-04-12 17:42:05,463 Stage-1 map = 3%,  reduce = 0%
2016-04-12 17:42:14,547 Stage-1 map = 4%,  reduce = 0%
2016-04-12 17:42:17,581 Stage-1 map = 6%,  reduce = 0%
2016-04-12 17:42:20,615 Stage-1 map = 7%,  reduce = 0%
2016-04-12 17:42:32,731 Stage-1 map = 8%,  reduce = 1%
2016-04-12 17:42:35,760 Stage-1 map = 9%,  reduce = 1%
2016-04-12 17:42:38,788 Stage-1 map = 10%,  reduce = 1%
2016-04-12 17:42:47,864 Stage-1 map = 11%,  reduce = 2%
2016-04-12 17:42:49,884 Stage-1 map = 12%,  reduce = 2%
2016-04-12 17:42:53,920 Stage-1 map = 13%,  reduce = 2%
2016-04-12 17:42:55,942 Stage-1 map = 14%,  reduce = 2%
2016-04-12 17:43:05,014 Stage-1 map = 15%,  reduce = 2%
2016-04-12 17:43:08,041 Stage-1 map = 16%,  reduce = 2%
2016-04-12 17:43:11,067 Stage-1 map = 17%,  reduce = 2%
2016-04-12 17:43:17,116 Stage-1 map = 18%,  reduce = 3%
2016-04-12 17:43:23,164 Stage-1 map = 20%,  reduce = 3%
2016-04-12 17:43:26,190 Stage-1 map = 21%,  reduce = 3%
2016-04-12 17:43:35,260 Stage-1 map = 22%,  reduce = 3%
2016-04-12 17:43:38,286 Stage-1 map = 23%,  reduce = 3%
2016-04-12 17:43:41,312 Stage-1 map = 24%,  reduce = 3%
2016-04-12 17:43:47,360 Stage-1 map = 25%,  reduce = 4%
2016-04-12 17:43:50,387 Stage-1 map = 26%,  reduce = 4%
2016-04-12 17:43:56,428 Stage-1 map = 27%,  reduce = 4%
2016-04-12 17:43:59,462 Stage-1 map = 28%,  reduce = 4%
2016-04-12 17:44:05,502 Stage-1 map = 29%,  reduce = 4%
2016-04-12 17:44:08,523 Stage-1 map = 30%,  reduce = 5%
2016-04-12 17:44:11,544 Stage-1 map = 31%,  reduce = 5%
2016-04-12 17:44:17,584 Stage-1 map = 32%,  reduce = 5%
2016-04-12 17:44:20,605 Stage-1 map = 33%,  reduce = 5%
2016-04-12 17:44:23,625 Stage-1 map = 34%,  reduce = 5%
2016-04-12 17:44:35,698 Stage-1 map = 35%,  reduce = 5%
2016-04-12 17:44:38,718 Stage-1 map = 36%,  reduce = 6%
2016-04-12 17:44:41,738 Stage-1 map = 37%,  reduce = 6%
2016-04-12 17:44:44,758 Stage-1 map = 38%,  reduce = 6%
2016-04-12 17:44:50,795 Stage-1 map = 39%,  reduce = 6%
2016-04-12 17:44:56,833 Stage-1 map = 40%,  reduce = 6%
2016-04-12 17:45:02,871 Stage-1 map = 41%,  reduce = 6%
2016-04-12 17:45:11,925 Stage-1 map = 42%,  reduce = 7%
2016-04-12 17:45:14,945 Stage-1 map = 43%,  reduce = 7%
2016-04-12 17:45:20,980 Stage-1 map = 44%,  reduce = 7%
2016-04-12 17:45:24,000 Stage-1 map = 46%,  reduce = 7%
2016-04-12 17:45:27,021 Stage-1 map = 47%,  reduce = 7%
2016-04-12 17:45:36,074 Stage-1 map = 47%,  reduce = 8%
2016-04-12 17:45:39,093 Stage-1 map = 49%,  reduce = 8%
2016-04-12 17:45:42,114 Stage-1 map = 50%,  reduce = 8%
2016-04-12 17:45:54,183 Stage-1 map = 51%,  reduce = 8%
2016-04-12 17:45:57,208 Stage-1 map = 53%,  reduce = 8%
2016-04-12 17:46:05,257 Stage-1 map = 54%,  reduce = 9%
2016-04-12 17:46:08,276 Stage-1 map = 55%,  reduce = 9%
2016-04-12 17:46:12,302 Stage-1 map = 56%,  reduce = 9%
2016-04-12 17:46:15,322 Stage-1 map = 57%,  reduce = 9%
2016-04-12 17:46:20,353 Stage-1 map = 58%,  reduce = 9%
2016-04-12 17:46:23,373 Stage-1 map = 59%,  reduce = 9%
2016-04-12 17:46:26,393 Stage-1 map = 60%,  reduce = 9%
2016-04-12 17:46:29,414 Stage-1 map = 60%,  reduce = 10%
2016-04-12 17:46:35,451 Stage-1 map = 61%,  reduce = 10%
2016-04-12 17:46:38,470 Stage-1 map = 63%,  reduce = 10%
2016-04-12 17:46:41,489 Stage-1 map = 64%,  reduce = 10%
2016-04-12 17:46:53,559 Stage-1 map = 66%,  reduce = 11%
2016-04-12 17:46:56,579 Stage-1 map = 67%,  reduce = 11%
2016-04-12 17:47:05,632 Stage-1 map = 68%,  reduce = 11%
2016-04-12 17:47:08,652 Stage-1 map = 69%,  reduce = 11%
2016-04-12 17:47:11,671 Stage-1 map = 70%,  reduce = 11%
2016-04-12 17:47:14,691 Stage-1 map = 71%,  reduce = 11%
2016-04-12 17:47:20,728 Stage-1 map = 72%,  reduce = 12%
2016-04-12 17:47:23,746 Stage-1 map = 73%,  reduce = 12%
2016-04-12 17:47:26,765 Stage-1 map = 74%,  reduce = 12%
2016-04-12 17:47:35,818 Stage-1 map = 75%,  reduce = 12%
2016-04-12 17:47:38,838 Stage-1 map = 76%,  reduce = 12%
2016-04-12 17:47:41,857 Stage-1 map = 77%,  reduce = 12%
2016-04-12 17:47:44,876 Stage-1 map = 78%,  reduce = 12%
2016-04-12 17:47:47,895 Stage-1 map = 78%,  reduce = 13%
2016-04-12 17:47:53,930 Stage-1 map = 79%,  reduce = 13%
2016-04-12 17:47:59,966 Stage-1 map = 81%,  reduce = 13%
2016-04-12 17:48:12,033 Stage-1 map = 82%,  reduce = 13%
2016-04-12 17:48:15,053 Stage-1 map = 83%,  reduce = 14%
2016-04-12 17:48:18,072 Stage-1 map = 84%,  reduce = 14%
2016-04-12 17:48:27,127 Stage-1 map = 85%,  reduce = 14%
2016-04-12 17:48:30,147 Stage-1 map = 86%,  reduce = 14%
2016-04-12 17:48:33,166 Stage-1 map = 87%,  reduce = 14%
2016-04-12 17:48:36,186 Stage-1 map = 88%,  reduce = 14%
2016-04-12 17:48:42,222 Stage-1 map = 88%,  reduce = 15%
2016-04-12 17:48:45,241 Stage-1 map = 89%,  reduce = 15%
2016-04-12 17:48:48,260 Stage-1 map = 91%,  reduce = 15%
2016-04-12 17:49:00,330 Stage-1 map = 92%,  reduce = 15%
2016-04-12 17:49:03,350 Stage-1 map = 93%,  reduce = 15%
2016-04-12 17:49:06,370 Stage-1 map = 95%,  reduce = 15%
2016-04-12 17:49:12,408 Stage-1 map = 95%,  reduce = 16%
2016-04-12 17:49:15,428 Stage-1 map = 96%,  reduce = 16%
2016-04-12 17:49:18,448 Stage-1 map = 97%,  reduce = 16%
2016-04-12 17:49:21,468 Stage-1 map = 98%,  reduce = 16%
2016-04-12 17:49:30,523 Stage-1 map = 99%,  reduce = 16%
2016-04-12 17:49:33,542 Stage-1 map = 100%,  reduce = 16%
2016-04-12 17:49:39,580 Stage-1 map = 100%,  reduce = 17%
2016-04-12 17:49:42,601 Stage-1 map = 100%,  reduce = 29%
2016-04-12 17:49:45,622 Stage-1 map = 100%,  reduce = 36%
2016-04-12 17:49:48,642 Stage-1 map = 100%,  reduce = 40%
2016-04-12 17:49:51,662 Stage-1 map = 100%,  reduce = 46%
2016-04-12 17:49:53,681 Stage-1 map = 100%,  reduce = 49%
2016-04-12 17:49:54,691 Stage-1 map = 100%,  reduce = 50%
2016-04-12 17:50:02,745 Stage-1 map = 100%,  reduce = 51%
2016-04-12 17:50:05,768 Stage-1 map = 100%,  reduce = 57%
2016-04-12 17:50:08,790 Stage-1 map = 100%,  reduce = 59%
2016-04-12 17:50:20,867 Stage-1 map = 100%,  reduce = 63%
2016-04-12 17:50:23,889 Stage-1 map = 100%,  reduce = 66%
2016-04-12 17:50:38,981 Stage-1 map = 100%,  reduce = 75%
2016-04-12 17:50:42,003 Stage-1 map = 100%,  reduce = 84%
2016-04-12 17:50:45,024 Stage-1 map = 100%,  reduce = 89%
2016-04-12 17:50:48,045 Stage-1 map = 100%,  reduce = 96%
2016-04-12 17:50:51,066 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121741_0001
Loading data to table lineitem_tmp
2000000 Rows loaded to lineitem_tmp
OK
Time taken: 550.224 seconds
Total MapReduce jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 9
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121741_0002, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121741_0002
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121741_0002
2016-04-12 17:51:00,491 Stage-1 map = 0%,  reduce = 0%
2016-04-12 17:51:09,535 Stage-1 map = 3%,  reduce = 0%
2016-04-12 17:51:18,583 Stage-1 map = 5%,  reduce = 0%
2016-04-12 17:51:21,601 Stage-1 map = 7%,  reduce = 0%
2016-04-12 17:51:30,648 Stage-1 map = 8%,  reduce = 0%
2016-04-12 17:51:33,705 Stage-1 map = 9%,  reduce = 1%
2016-04-12 17:51:36,724 Stage-1 map = 10%,  reduce = 1%
2016-04-12 17:51:42,756 Stage-1 map = 11%,  reduce = 1%
2016-04-12 17:51:45,773 Stage-1 map = 12%,  reduce = 1%
2016-04-12 17:51:48,791 Stage-1 map = 13%,  reduce = 1%
2016-04-12 17:51:51,809 Stage-1 map = 13%,  reduce = 2%
2016-04-12 17:51:54,827 Stage-1 map = 14%,  reduce = 2%
2016-04-12 17:51:57,846 Stage-1 map = 15%,  reduce = 2%
2016-04-12 17:52:00,864 Stage-1 map = 17%,  reduce = 2%
2016-04-12 17:52:06,899 Stage-1 map = 18%,  reduce = 2%
2016-04-12 17:52:08,912 Stage-1 map = 19%,  reduce = 2%
2016-04-12 17:52:12,936 Stage-1 map = 20%,  reduce = 2%
2016-04-12 17:52:14,951 Stage-1 map = 21%,  reduce = 3%
2016-04-12 17:52:20,984 Stage-1 map = 22%,  reduce = 3%
2016-04-12 17:52:24,003 Stage-1 map = 24%,  reduce = 3%
2016-04-12 17:52:33,049 Stage-1 map = 25%,  reduce = 3%
2016-04-12 17:52:36,067 Stage-1 map = 27%,  reduce = 4%
2016-04-12 17:52:39,086 Stage-1 map = 28%,  reduce = 4%
2016-04-12 17:52:45,120 Stage-1 map = 29%,  reduce = 4%
2016-04-12 17:52:48,138 Stage-1 map = 30%,  reduce = 4%
2016-04-12 17:52:51,157 Stage-1 map = 31%,  reduce = 4%
2016-04-12 17:52:57,190 Stage-1 map = 32%,  reduce = 4%
2016-04-12 17:53:00,208 Stage-1 map = 34%,  reduce = 5%
2016-04-12 17:53:09,257 Stage-1 map = 35%,  reduce = 5%
2016-04-12 17:53:12,275 Stage-1 map = 37%,  reduce = 5%
2016-04-12 17:53:21,323 Stage-1 map = 39%,  reduce = 5%
2016-04-12 17:53:24,340 Stage-1 map = 40%,  reduce = 5%
2016-04-12 17:53:27,359 Stage-1 map = 40%,  reduce = 6%
2016-04-12 17:53:30,377 Stage-1 map = 41%,  reduce = 6%
2016-04-12 17:53:36,410 Stage-1 map = 42%,  reduce = 6%
2016-04-12 17:53:39,428 Stage-1 map = 43%,  reduce = 6%
2016-04-12 17:53:42,446 Stage-1 map = 44%,  reduce = 6%
2016-04-12 17:53:48,482 Stage-1 map = 45%,  reduce = 6%
2016-04-12 17:53:51,500 Stage-1 map = 46%,  reduce = 6%
2016-04-12 17:53:54,518 Stage-1 map = 47%,  reduce = 6%
2016-04-12 17:53:57,536 Stage-1 map = 47%,  reduce = 7%
2016-04-12 17:54:00,555 Stage-1 map = 49%,  reduce = 7%
2016-04-12 17:54:06,588 Stage-1 map = 50%,  reduce = 7%
2016-04-12 17:54:09,606 Stage-1 map = 51%,  reduce = 7%
2016-04-12 17:54:12,625 Stage-1 map = 52%,  reduce = 7%
2016-04-12 17:54:18,659 Stage-1 map = 54%,  reduce = 7%
2016-04-12 17:54:21,678 Stage-1 map = 54%,  reduce = 8%
2016-04-12 17:54:24,696 Stage-1 map = 55%,  reduce = 8%
2016-04-12 17:54:27,715 Stage-1 map = 56%,  reduce = 8%
2016-04-12 17:54:30,733 Stage-1 map = 57%,  reduce = 8%
2016-04-12 17:54:33,752 Stage-1 map = 58%,  reduce = 8%
2016-04-12 17:54:36,771 Stage-1 map = 59%,  reduce = 8%
2016-04-12 17:54:42,806 Stage-1 map = 60%,  reduce = 9%
2016-04-12 17:54:45,825 Stage-1 map = 61%,  reduce = 9%
2016-04-12 17:54:48,844 Stage-1 map = 62%,  reduce = 9%
2016-04-12 17:54:51,863 Stage-1 map = 63%,  reduce = 9%
2016-04-12 17:54:54,882 Stage-1 map = 64%,  reduce = 9%
2016-04-12 17:55:00,917 Stage-1 map = 65%,  reduce = 9%
2016-04-12 17:55:03,936 Stage-1 map = 66%,  reduce = 9%
2016-04-12 17:55:06,955 Stage-1 map = 67%,  reduce = 10%
2016-04-12 17:55:09,974 Stage-1 map = 68%,  reduce = 10%
2016-04-12 17:55:12,994 Stage-1 map = 69%,  reduce = 10%
2016-04-12 17:55:19,029 Stage-1 map = 70%,  reduce = 10%
2016-04-12 17:55:22,048 Stage-1 map = 71%,  reduce = 10%
2016-04-12 17:55:25,067 Stage-1 map = 72%,  reduce = 10%
2016-04-12 17:55:28,087 Stage-1 map = 73%,  reduce = 10%
2016-04-12 17:55:34,123 Stage-1 map = 74%,  reduce = 11%
2016-04-12 17:55:40,157 Stage-1 map = 75%,  reduce = 11%
2016-04-12 17:55:43,176 Stage-1 map = 76%,  reduce = 11%
2016-04-12 17:55:46,196 Stage-1 map = 77%,  reduce = 11%
2016-04-12 17:55:57,256 Stage-1 map = 80%,  reduce = 11%
2016-04-12 17:56:00,275 Stage-1 map = 81%,  reduce = 11%
2016-04-12 17:56:03,294 Stage-1 map = 81%,  reduce = 12%
2016-04-12 17:56:09,327 Stage-1 map = 83%,  reduce = 12%
2016-04-12 17:56:12,344 Stage-1 map = 84%,  reduce = 12%
2016-04-12 17:56:21,390 Stage-1 map = 86%,  reduce = 12%
2016-04-12 17:56:24,409 Stage-1 map = 87%,  reduce = 12%
2016-04-12 17:56:30,443 Stage-1 map = 87%,  reduce = 13%
2016-04-12 17:56:33,461 Stage-1 map = 90%,  reduce = 13%
2016-04-12 17:56:36,479 Stage-1 map = 91%,  reduce = 13%
2016-04-12 17:56:45,526 Stage-1 map = 93%,  reduce = 13%
2016-04-12 17:56:48,544 Stage-1 map = 94%,  reduce = 13%
2016-04-12 17:56:51,563 Stage-1 map = 94%,  reduce = 14%
2016-04-12 17:56:57,597 Stage-1 map = 96%,  reduce = 14%
2016-04-12 17:57:00,615 Stage-1 map = 97%,  reduce = 14%
2016-04-12 17:57:09,662 Stage-1 map = 100%,  reduce = 14%
2016-04-12 17:57:12,681 Stage-1 map = 100%,  reduce = 15%
2016-04-12 17:57:18,716 Stage-1 map = 100%,  reduce = 18%
2016-04-12 17:57:21,735 Stage-1 map = 100%,  reduce = 27%
2016-04-12 17:57:24,754 Stage-1 map = 100%,  reduce = 35%
2016-04-12 17:57:27,773 Stage-1 map = 100%,  reduce = 39%
2016-04-12 17:57:30,795 Stage-1 map = 100%,  reduce = 43%
2016-04-12 17:57:33,815 Stage-1 map = 100%,  reduce = 44%
2016-04-12 17:57:39,850 Stage-1 map = 100%,  reduce = 46%
2016-04-12 17:57:42,870 Stage-1 map = 100%,  reduce = 50%
2016-04-12 17:57:45,889 Stage-1 map = 100%,  reduce = 52%
2016-04-12 17:57:54,941 Stage-1 map = 100%,  reduce = 54%
2016-04-12 17:57:57,960 Stage-1 map = 100%,  reduce = 57%
2016-04-12 17:58:10,026 Stage-1 map = 100%,  reduce = 58%
2016-04-12 17:58:13,046 Stage-1 map = 100%,  reduce = 67%
2016-04-12 17:58:16,065 Stage-1 map = 100%,  reduce = 75%
2016-04-12 17:58:19,083 Stage-1 map = 100%,  reduce = 79%
2016-04-12 17:58:22,103 Stage-1 map = 100%,  reduce = 85%
2016-04-12 17:58:25,122 Stage-1 map = 100%,  reduce = 89%
2016-04-12 17:58:31,158 Stage-1 map = 100%,  reduce = 90%
2016-04-12 17:58:34,177 Stage-1 map = 100%,  reduce = 91%
2016-04-12 17:58:40,211 Stage-1 map = 100%,  reduce = 92%
2016-04-12 17:58:46,244 Stage-1 map = 100%,  reduce = 93%
2016-04-12 17:58:49,263 Stage-1 map = 100%,  reduce = 97%
2016-04-12 17:58:52,282 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121741_0002
Launching Job 2 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121741_0003, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121741_0003
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121741_0003
2016-04-12 17:59:00,892 Stage-2 map = 0%,  reduce = 0%
2016-04-12 17:59:09,926 Stage-2 map = 24%,  reduce = 0%
2016-04-12 17:59:18,964 Stage-2 map = 47%,  reduce = 8%
2016-04-12 17:59:24,990 Stage-2 map = 71%,  reduce = 8%
2016-04-12 17:59:28,005 Stage-2 map = 71%,  reduce = 16%
2016-04-12 17:59:31,018 Stage-2 map = 94%,  reduce = 16%
2016-04-12 17:59:34,032 Stage-2 map = 100%,  reduce = 31%
2016-04-12 17:59:43,069 Stage-2 map = 100%,  reduce = 94%
2016-04-12 17:59:46,083 Stage-2 map = 100%,  reduce = 100%
Ended Job = job_201604121741_0003
Launching Job 3 out of 3
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121741_0004, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121741_0004
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121741_0004
2016-04-12 17:59:54,572 Stage-3 map = 0%,  reduce = 0%
2016-04-12 17:59:57,585 Stage-3 map = 100%,  reduce = 0%
2016-04-12 18:00:06,620 Stage-3 map = 100%,  reduce = 100%
Ended Job = job_201604121741_0004
Loading data to table q17_small_quantity_order_revenue
1 Rows loaded to q17_small_quantity_order_revenue
OK
Time taken: 555.447 seconds
Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121801_1061624056.txt
OK
Time taken: 3.46 seconds
OK
Time taken: 0.065 seconds
FAILED: Error in metadata: MetaException(message:Got exception: org.apache.hadoop.ipc.RemoteException org.apache.hadoop.hdfs.server.namenode.SafeModeException: Cannot delete /user/hive/warehouse/q17_small_quantity_order_revenue. Name node is in safe mode.
The ratio of reported blocks 1.0000 has reached the threshold 0.9990. Safe mode will be turned off automatically in 24 seconds.
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.deleteInternal(FSNamesystem.java:1700)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.delete(FSNamesystem.java:1680)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.delete(NameNode.java:517)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:508)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:959)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:955)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:953)
)
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121801_1695511288.txt
OK
Time taken: 2.822 seconds
OK
Time taken: 0.007 seconds
OK
Time taken: 0.01 seconds
OK
Time taken: 0.659 seconds
OK
Time taken: 0.183 seconds
OK
Time taken: 0.033 seconds
OK
Time taken: 0.037 seconds
OK
Time taken: 0.063 seconds
Total MapReduce jobs = 1
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 8
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121801_0001, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121801_0001
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121801_0001
2016-04-12 18:01:34,005 Stage-1 map = 0%,  reduce = 0%
2016-04-12 18:01:43,072 Stage-1 map = 1%,  reduce = 0%
2016-04-12 18:01:46,095 Stage-1 map = 2%,  reduce = 0%
2016-04-12 18:01:49,129 Stage-1 map = 3%,  reduce = 0%
2016-04-12 18:01:58,211 Stage-1 map = 4%,  reduce = 0%
2016-04-12 18:02:01,241 Stage-1 map = 5%,  reduce = 0%
2016-04-12 18:02:04,272 Stage-1 map = 6%,  reduce = 0%
2016-04-12 18:02:07,304 Stage-1 map = 7%,  reduce = 0%
2016-04-12 18:02:16,388 Stage-1 map = 8%,  reduce = 1%
2016-04-12 18:02:22,440 Stage-1 map = 9%,  reduce = 1%
2016-04-12 18:02:25,468 Stage-1 map = 10%,  reduce = 1%
2016-04-12 18:02:31,520 Stage-1 map = 11%,  reduce = 1%
2016-04-12 18:02:34,549 Stage-1 map = 12%,  reduce = 2%
2016-04-12 18:02:37,579 Stage-1 map = 13%,  reduce = 2%
2016-04-12 18:02:39,599 Stage-1 map = 14%,  reduce = 2%
2016-04-12 18:02:45,650 Stage-1 map = 15%,  reduce = 2%
2016-04-12 18:02:51,699 Stage-1 map = 16%,  reduce = 2%
2016-04-12 18:02:54,726 Stage-1 map = 17%,  reduce = 2%
2016-04-12 18:03:00,775 Stage-1 map = 18%,  reduce = 2%
2016-04-12 18:03:03,800 Stage-1 map = 19%,  reduce = 3%
2016-04-12 18:03:09,849 Stage-1 map = 20%,  reduce = 3%
2016-04-12 18:03:12,874 Stage-1 map = 21%,  reduce = 3%
2016-04-12 18:03:15,900 Stage-1 map = 22%,  reduce = 3%
2016-04-12 18:03:21,947 Stage-1 map = 23%,  reduce = 3%
2016-04-12 18:03:24,974 Stage-1 map = 24%,  reduce = 3%
2016-04-12 18:03:28,002 Stage-1 map = 24%,  reduce = 4%
2016-04-12 18:03:31,029 Stage-1 map = 25%,  reduce = 4%
2016-04-12 18:03:34,050 Stage-1 map = 26%,  reduce = 4%
2016-04-12 18:03:40,090 Stage-1 map = 27%,  reduce = 4%
2016-04-12 18:03:43,111 Stage-1 map = 28%,  reduce = 4%
2016-04-12 18:03:49,150 Stage-1 map = 29%,  reduce = 4%
2016-04-12 18:03:52,171 Stage-1 map = 30%,  reduce = 4%
2016-04-12 18:03:55,193 Stage-1 map = 31%,  reduce = 5%
2016-04-12 18:04:04,249 Stage-1 map = 32%,  reduce = 5%
2016-04-12 18:04:07,270 Stage-1 map = 33%,  reduce = 5%
2016-04-12 18:04:10,292 Stage-1 map = 34%,  reduce = 5%
2016-04-12 18:04:16,331 Stage-1 map = 35%,  reduce = 5%
2016-04-12 18:04:19,351 Stage-1 map = 36%,  reduce = 5%
2016-04-12 18:04:22,371 Stage-1 map = 37%,  reduce = 6%
2016-04-12 18:04:28,410 Stage-1 map = 38%,  reduce = 6%
2016-04-12 18:04:34,449 Stage-1 map = 39%,  reduce = 6%
2016-04-12 18:04:40,486 Stage-1 map = 41%,  reduce = 6%
2016-04-12 18:04:46,525 Stage-1 map = 41%,  reduce = 7%
2016-04-12 18:04:52,560 Stage-1 map = 42%,  reduce = 7%
2016-04-12 18:04:55,580 Stage-1 map = 44%,  reduce = 7%
2016-04-12 18:04:58,600 Stage-1 map = 45%,  reduce = 7%
2016-04-12 18:05:04,636 Stage-1 map = 46%,  reduce = 7%
2016-04-12 18:05:10,673 Stage-1 map = 47%,  reduce = 7%
2016-04-12 18:05:13,693 Stage-1 map = 48%,  reduce = 7%
2016-04-12 18:05:16,712 Stage-1 map = 48%,  reduce = 8%
2016-04-12 18:05:22,750 Stage-1 map = 49%,  reduce = 8%
2016-04-12 18:05:28,787 Stage-1 map = 51%,  reduce = 8%
2016-04-12 18:05:31,808 Stage-1 map = 52%,  reduce = 8%
2016-04-12 18:05:40,861 Stage-1 map = 54%,  reduce = 9%
2016-04-12 18:05:43,882 Stage-1 map = 55%,  reduce = 9%
2016-04-12 18:05:52,946 Stage-1 map = 56%,  reduce = 9%
2016-04-12 18:05:54,959 Stage-1 map = 57%,  reduce = 9%
2016-04-12 18:05:57,979 Stage-1 map = 58%,  reduce = 9%
2016-04-12 18:05:58,992 Stage-1 map = 59%,  reduce = 9%
2016-04-12 18:06:10,057 Stage-1 map = 61%,  reduce = 10%
2016-04-12 18:06:13,076 Stage-1 map = 62%,  reduce = 10%
2016-04-12 18:06:22,129 Stage-1 map = 63%,  reduce = 10%
2016-04-12 18:06:25,148 Stage-1 map = 64%,  reduce = 10%
2016-04-12 18:06:28,167 Stage-1 map = 65%,  reduce = 10%
2016-04-12 18:06:31,187 Stage-1 map = 66%,  reduce = 10%
2016-04-12 18:06:37,221 Stage-1 map = 66%,  reduce = 11%
2016-04-12 18:06:40,240 Stage-1 map = 67%,  reduce = 11%
2016-04-12 18:06:43,260 Stage-1 map = 68%,  reduce = 11%
2016-04-12 18:06:46,279 Stage-1 map = 69%,  reduce = 11%
2016-04-12 18:06:52,313 Stage-1 map = 70%,  reduce = 11%
2016-04-12 18:06:55,333 Stage-1 map = 71%,  reduce = 11%
2016-04-12 18:06:58,354 Stage-1 map = 72%,  reduce = 11%
2016-04-12 18:07:04,390 Stage-1 map = 72%,  reduce = 12%
2016-04-12 18:07:07,409 Stage-1 map = 73%,  reduce = 12%
2016-04-12 18:07:10,429 Stage-1 map = 74%,  reduce = 12%
2016-04-12 18:07:13,449 Stage-1 map = 76%,  reduce = 12%
2016-04-12 18:07:22,502 Stage-1 map = 76%,  reduce = 13%
2016-04-12 18:07:25,522 Stage-1 map = 77%,  reduce = 13%
2016-04-12 18:07:28,549 Stage-1 map = 78%,  reduce = 13%
2016-04-12 18:07:31,569 Stage-1 map = 79%,  reduce = 13%
2016-04-12 18:07:40,620 Stage-1 map = 80%,  reduce = 13%
2016-04-12 18:07:43,639 Stage-1 map = 82%,  reduce = 13%
2016-04-12 18:07:49,675 Stage-1 map = 83%,  reduce = 13%
2016-04-12 18:07:55,712 Stage-1 map = 83%,  reduce = 14%
2016-04-12 18:07:58,732 Stage-1 map = 85%,  reduce = 14%
2016-04-12 18:08:01,752 Stage-1 map = 86%,  reduce = 14%
2016-04-12 18:08:10,806 Stage-1 map = 87%,  reduce = 14%
2016-04-12 18:08:13,825 Stage-1 map = 88%,  reduce = 14%
2016-04-12 18:08:16,846 Stage-1 map = 89%,  reduce = 14%
2016-04-12 18:08:19,866 Stage-1 map = 90%,  reduce = 14%
2016-04-12 18:08:22,886 Stage-1 map = 90%,  reduce = 15%
2016-04-12 18:08:25,905 Stage-1 map = 91%,  reduce = 15%
2016-04-12 18:08:28,925 Stage-1 map = 92%,  reduce = 15%
2016-04-12 18:08:31,944 Stage-1 map = 93%,  reduce = 15%
2016-04-12 18:08:40,996 Stage-1 map = 94%,  reduce = 15%
2016-04-12 18:08:44,015 Stage-1 map = 95%,  reduce = 15%
2016-04-12 18:08:47,035 Stage-1 map = 96%,  reduce = 16%
2016-04-12 18:08:50,055 Stage-1 map = 97%,  reduce = 16%
2016-04-12 18:08:59,108 Stage-1 map = 99%,  reduce = 16%
2016-04-12 18:09:02,135 Stage-1 map = 100%,  reduce = 16%
2016-04-12 18:09:13,197 Stage-1 map = 100%,  reduce = 17%
2016-04-12 18:09:14,205 Stage-1 map = 100%,  reduce = 21%
2016-04-12 18:09:16,219 Stage-1 map = 100%,  reduce = 29%
2016-04-12 18:09:17,228 Stage-1 map = 100%,  reduce = 34%
2016-04-12 18:09:19,242 Stage-1 map = 100%,  reduce = 35%
2016-04-12 18:09:20,250 Stage-1 map = 100%,  reduce = 37%
2016-04-12 18:09:22,264 Stage-1 map = 100%,  reduce = 40%
2016-04-12 18:09:23,273 Stage-1 map = 100%,  reduce = 42%
2016-04-12 18:09:25,291 Stage-1 map = 100%,  reduce = 47%
2016-04-12 18:09:26,300 Stage-1 map = 100%,  reduce = 49%
2016-04-12 18:09:28,315 Stage-1 map = 100%,  reduce = 50%
2016-04-12 18:09:34,356 Stage-1 map = 100%,  reduce = 52%
2016-04-12 18:09:37,377 Stage-1 map = 100%,  reduce = 56%
2016-04-12 18:09:40,398 Stage-1 map = 100%,  reduce = 59%
2016-04-12 18:09:52,476 Stage-1 map = 100%,  reduce = 61%
2016-04-12 18:09:55,497 Stage-1 map = 100%,  reduce = 66%
2016-04-12 18:10:10,594 Stage-1 map = 100%,  reduce = 71%
2016-04-12 18:10:13,616 Stage-1 map = 100%,  reduce = 80%
2016-04-12 18:10:16,638 Stage-1 map = 100%,  reduce = 87%
2016-04-12 18:10:19,659 Stage-1 map = 100%,  reduce = 93%
2016-04-12 18:10:22,682 Stage-1 map = 100%,  reduce = 97%
2016-04-12 18:10:25,705 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121801_0001
Loading data to table lineitem_tmp
2000000 Rows loaded to lineitem_tmp
OK
Time taken: 541.265 seconds
Total MapReduce jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 9
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121801_0002, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121801_0002
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121801_0002
2016-04-12 18:10:34,671 Stage-1 map = 0%,  reduce = 0%
2016-04-12 18:10:43,740 Stage-1 map = 3%,  reduce = 0%
2016-04-12 18:10:52,788 Stage-1 map = 5%,  reduce = 0%
2016-04-12 18:10:55,806 Stage-1 map = 7%,  reduce = 0%
2016-04-12 18:11:04,852 Stage-1 map = 8%,  reduce = 0%
2016-04-12 18:11:07,870 Stage-1 map = 10%,  reduce = 0%
2016-04-12 18:11:10,889 Stage-1 map = 10%,  reduce = 1%
2016-04-12 18:11:19,935 Stage-1 map = 12%,  reduce = 1%
2016-04-12 18:11:22,954 Stage-1 map = 13%,  reduce = 1%
2016-04-12 18:11:28,988 Stage-1 map = 13%,  reduce = 2%
2016-04-12 18:11:32,006 Stage-1 map = 15%,  reduce = 2%
2016-04-12 18:11:35,024 Stage-1 map = 17%,  reduce = 2%
2016-04-12 18:11:44,072 Stage-1 map = 19%,  reduce = 2%
2016-04-12 18:11:47,090 Stage-1 map = 20%,  reduce = 2%
2016-04-12 18:11:50,109 Stage-1 map = 20%,  reduce = 3%
2016-04-12 18:11:56,142 Stage-1 map = 22%,  reduce = 3%
2016-04-12 18:11:59,159 Stage-1 map = 23%,  reduce = 3%
2016-04-12 18:12:08,206 Stage-1 map = 25%,  reduce = 3%
2016-04-12 18:12:11,224 Stage-1 map = 27%,  reduce = 3%
2016-04-12 18:12:20,277 Stage-1 map = 29%,  reduce = 4%
2016-04-12 18:12:23,295 Stage-1 map = 30%,  reduce = 4%
2016-04-12 18:12:32,343 Stage-1 map = 32%,  reduce = 4%
2016-04-12 18:12:35,361 Stage-1 map = 33%,  reduce = 4%
2016-04-12 18:12:41,394 Stage-1 map = 33%,  reduce = 5%
2016-04-12 18:12:44,412 Stage-1 map = 35%,  reduce = 5%
2016-04-12 18:12:47,430 Stage-1 map = 37%,  reduce = 5%
2016-04-12 18:12:56,479 Stage-1 map = 38%,  reduce = 5%
2016-04-12 18:12:59,497 Stage-1 map = 39%,  reduce = 5%
2016-04-12 18:13:02,515 Stage-1 map = 40%,  reduce = 5%
2016-04-12 18:13:08,547 Stage-1 map = 40%,  reduce = 6%
2016-04-12 18:13:11,565 Stage-1 map = 42%,  reduce = 6%
2016-04-12 18:13:14,583 Stage-1 map = 43%,  reduce = 6%
2016-04-12 18:13:20,615 Stage-1 map = 44%,  reduce = 6%
2016-04-12 18:13:22,628 Stage-1 map = 45%,  reduce = 6%
2016-04-12 18:13:25,646 Stage-1 map = 46%,  reduce = 6%
2016-04-12 18:13:26,654 Stage-1 map = 47%,  reduce = 6%
2016-04-12 18:13:31,684 Stage-1 map = 47%,  reduce = 7%
2016-04-12 18:13:34,701 Stage-1 map = 49%,  reduce = 7%
2016-04-12 18:13:37,719 Stage-1 map = 50%,  reduce = 7%
2016-04-12 18:13:40,737 Stage-1 map = 51%,  reduce = 7%
2016-04-12 18:13:49,786 Stage-1 map = 53%,  reduce = 7%
2016-04-12 18:13:52,804 Stage-1 map = 54%,  reduce = 8%
2016-04-12 18:14:01,853 Stage-1 map = 56%,  reduce = 8%
2016-04-12 18:14:04,871 Stage-1 map = 57%,  reduce = 8%
2016-04-12 18:14:13,921 Stage-1 map = 59%,  reduce = 8%
2016-04-12 18:14:16,941 Stage-1 map = 61%,  reduce = 8%
2016-04-12 18:14:19,959 Stage-1 map = 61%,  reduce = 9%
2016-04-12 18:14:25,994 Stage-1 map = 62%,  reduce = 9%
2016-04-12 18:14:29,012 Stage-1 map = 63%,  reduce = 9%
2016-04-12 18:14:32,032 Stage-1 map = 64%,  reduce = 9%
2016-04-12 18:14:35,051 Stage-1 map = 65%,  reduce = 9%
2016-04-12 18:14:41,089 Stage-1 map = 67%,  reduce = 9%
2016-04-12 18:14:44,107 Stage-1 map = 67%,  reduce = 10%
2016-04-12 18:14:47,126 Stage-1 map = 68%,  reduce = 10%
2016-04-12 18:14:53,160 Stage-1 map = 70%,  reduce = 10%
2016-04-12 18:14:56,179 Stage-1 map = 71%,  reduce = 10%
2016-04-12 18:14:59,198 Stage-1 map = 72%,  reduce = 10%
2016-04-12 18:15:05,232 Stage-1 map = 73%,  reduce = 10%
2016-04-12 18:15:08,251 Stage-1 map = 74%,  reduce = 11%
2016-04-12 18:15:11,270 Stage-1 map = 75%,  reduce = 11%
2016-04-12 18:15:20,320 Stage-1 map = 77%,  reduce = 11%
2016-04-12 18:15:23,339 Stage-1 map = 78%,  reduce = 11%
2016-04-12 18:15:32,393 Stage-1 map = 80%,  reduce = 11%
2016-04-12 18:15:35,413 Stage-1 map = 82%,  reduce = 12%
2016-04-12 18:15:44,463 Stage-1 map = 84%,  reduce = 12%
2016-04-12 18:15:47,485 Stage-1 map = 85%,  reduce = 12%
2016-04-12 18:15:53,518 Stage-1 map = 86%,  reduce = 12%
2016-04-12 18:15:56,536 Stage-1 map = 87%,  reduce = 13%
2016-04-12 18:15:59,555 Stage-1 map = 88%,  reduce = 13%
2016-04-12 18:16:05,589 Stage-1 map = 89%,  reduce = 13%
2016-04-12 18:16:08,607 Stage-1 map = 91%,  reduce = 13%
2016-04-12 18:16:11,626 Stage-1 map = 92%,  reduce = 13%
2016-04-12 18:16:20,676 Stage-1 map = 94%,  reduce = 13%
2016-04-12 18:16:23,694 Stage-1 map = 95%,  reduce = 14%
2016-04-12 18:16:26,714 Stage-1 map = 96%,  reduce = 14%
2016-04-12 18:16:32,749 Stage-1 map = 98%,  reduce = 14%
2016-04-12 18:16:38,783 Stage-1 map = 99%,  reduce = 14%
2016-04-12 18:16:44,818 Stage-1 map = 100%,  reduce = 15%
2016-04-12 18:16:50,853 Stage-1 map = 100%,  reduce = 23%
2016-04-12 18:16:53,872 Stage-1 map = 100%,  reduce = 32%
2016-04-12 18:16:55,886 Stage-1 map = 100%,  reduce = 35%
2016-04-12 18:16:56,895 Stage-1 map = 100%,  reduce = 37%
2016-04-12 18:16:58,909 Stage-1 map = 100%,  reduce = 39%
2016-04-12 18:16:59,917 Stage-1 map = 100%,  reduce = 42%
2016-04-12 18:17:01,934 Stage-1 map = 100%,  reduce = 43%
2016-04-12 18:17:02,943 Stage-1 map = 100%,  reduce = 44%
2016-04-12 18:17:10,989 Stage-1 map = 100%,  reduce = 46%
2016-04-12 18:17:14,009 Stage-1 map = 100%,  reduce = 50%
2016-04-12 18:17:17,028 Stage-1 map = 100%,  reduce = 52%
2016-04-12 18:17:26,078 Stage-1 map = 100%,  reduce = 53%
2016-04-12 18:17:29,098 Stage-1 map = 100%,  reduce = 57%
2016-04-12 18:17:41,164 Stage-1 map = 100%,  reduce = 58%
2016-04-12 18:17:44,183 Stage-1 map = 100%,  reduce = 67%
2016-04-12 18:17:47,202 Stage-1 map = 100%,  reduce = 75%
2016-04-12 18:17:50,220 Stage-1 map = 100%,  reduce = 79%
2016-04-12 18:17:53,239 Stage-1 map = 100%,  reduce = 84%
2016-04-12 18:17:56,259 Stage-1 map = 100%,  reduce = 89%
2016-04-12 18:18:05,309 Stage-1 map = 100%,  reduce = 90%
2016-04-12 18:18:08,329 Stage-1 map = 100%,  reduce = 91%
2016-04-12 18:18:14,363 Stage-1 map = 100%,  reduce = 92%
2016-04-12 18:18:23,414 Stage-1 map = 100%,  reduce = 96%
2016-04-12 18:18:26,433 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121801_0002
Launching Job 2 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121801_0003, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121801_0003
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121801_0003
2016-04-12 18:18:35,044 Stage-2 map = 0%,  reduce = 0%
2016-04-12 18:18:44,077 Stage-2 map = 24%,  reduce = 0%
2016-04-12 18:18:53,114 Stage-2 map = 47%,  reduce = 8%
2016-04-12 18:18:59,140 Stage-2 map = 71%,  reduce = 8%
2016-04-12 18:19:02,154 Stage-2 map = 71%,  reduce = 16%
2016-04-12 18:19:05,168 Stage-2 map = 94%,  reduce = 16%
2016-04-12 18:19:08,182 Stage-2 map = 100%,  reduce = 31%
2016-04-12 18:19:17,220 Stage-2 map = 100%,  reduce = 97%
2016-04-12 18:19:20,234 Stage-2 map = 100%,  reduce = 100%
Ended Job = job_201604121801_0003
Launching Job 3 out of 3
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121801_0004, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121801_0004
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121801_0004
2016-04-12 18:19:29,719 Stage-3 map = 0%,  reduce = 0%
2016-04-12 18:19:32,732 Stage-3 map = 100%,  reduce = 0%
2016-04-12 18:19:41,769 Stage-3 map = 100%,  reduce = 100%
Ended Job = job_201604121801_0004
Loading data to table q17_small_quantity_order_revenue
1 Rows loaded to q17_small_quantity_order_revenue
OK
Time taken: 555.98 seconds
Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121820_701286264.txt
OK
Time taken: 3.36 seconds
OK
Time taken: 0.079 seconds
FAILED: Error in metadata: MetaException(message:Got exception: org.apache.hadoop.ipc.RemoteException org.apache.hadoop.hdfs.server.namenode.SafeModeException: Cannot delete /user/hive/warehouse/q17_small_quantity_order_revenue. Name node is in safe mode.
The ratio of reported blocks 1.0000 has reached the threshold 0.9990. Safe mode will be turned off automatically in 24 seconds.
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.deleteInternal(FSNamesystem.java:1700)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.delete(FSNamesystem.java:1680)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.delete(NameNode.java:517)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:508)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:959)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:955)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:953)
)
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121820_1157372528.txt
OK
Time taken: 2.928 seconds
OK
Time taken: 0.007 seconds
OK
Time taken: 0.011 seconds
OK
Time taken: 0.665 seconds
OK
Time taken: 0.166 seconds
OK
Time taken: 0.032 seconds
OK
Time taken: 0.024 seconds
OK
Time taken: 0.076 seconds
Total MapReduce jobs = 1
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 8
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121820_0001, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121820_0001
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121820_0001
2016-04-12 18:21:08,063 Stage-1 map = 0%,  reduce = 0%
2016-04-12 18:21:17,134 Stage-1 map = 1%,  reduce = 0%
2016-04-12 18:21:20,156 Stage-1 map = 3%,  reduce = 0%
2016-04-12 18:21:32,272 Stage-1 map = 4%,  reduce = 0%
2016-04-12 18:21:35,303 Stage-1 map = 6%,  reduce = 0%
2016-04-12 18:21:38,335 Stage-1 map = 7%,  reduce = 0%
2016-04-12 18:21:47,424 Stage-1 map = 7%,  reduce = 1%
2016-04-12 18:21:50,456 Stage-1 map = 8%,  reduce = 1%
2016-04-12 18:21:53,486 Stage-1 map = 9%,  reduce = 1%
2016-04-12 18:21:56,513 Stage-1 map = 10%,  reduce = 1%
2016-04-12 18:22:04,580 Stage-1 map = 11%,  reduce = 1%
2016-04-12 18:22:05,593 Stage-1 map = 11%,  reduce = 2%
2016-04-12 18:22:07,614 Stage-1 map = 12%,  reduce = 2%
2016-04-12 18:22:10,645 Stage-1 map = 13%,  reduce = 2%
2016-04-12 18:22:13,675 Stage-1 map = 14%,  reduce = 2%
2016-04-12 18:22:22,747 Stage-1 map = 16%,  reduce = 2%
2016-04-12 18:22:25,774 Stage-1 map = 17%,  reduce = 2%
2016-04-12 18:22:34,848 Stage-1 map = 18%,  reduce = 3%
2016-04-12 18:22:37,874 Stage-1 map = 19%,  reduce = 3%
2016-04-12 18:22:40,900 Stage-1 map = 20%,  reduce = 3%
2016-04-12 18:22:43,928 Stage-1 map = 21%,  reduce = 3%
2016-04-12 18:22:49,978 Stage-1 map = 22%,  reduce = 3%
2016-04-12 18:22:53,004 Stage-1 map = 23%,  reduce = 3%
2016-04-12 18:22:56,030 Stage-1 map = 24%,  reduce = 3%
2016-04-12 18:23:05,103 Stage-1 map = 25%,  reduce = 4%
2016-04-12 18:23:08,126 Stage-1 map = 26%,  reduce = 4%
2016-04-12 18:23:11,148 Stage-1 map = 27%,  reduce = 4%
2016-04-12 18:23:14,170 Stage-1 map = 28%,  reduce = 4%
2016-04-12 18:23:23,228 Stage-1 map = 30%,  reduce = 5%
2016-04-12 18:23:26,249 Stage-1 map = 31%,  reduce = 5%
2016-04-12 18:23:35,307 Stage-1 map = 32%,  reduce = 5%
2016-04-12 18:23:38,328 Stage-1 map = 33%,  reduce = 5%
2016-04-12 18:23:41,348 Stage-1 map = 34%,  reduce = 5%
2016-04-12 18:23:50,404 Stage-1 map = 35%,  reduce = 6%
2016-04-12 18:23:53,423 Stage-1 map = 37%,  reduce = 6%
2016-04-12 18:23:59,460 Stage-1 map = 38%,  reduce = 6%
2016-04-12 18:24:08,514 Stage-1 map = 39%,  reduce = 6%
2016-04-12 18:24:11,534 Stage-1 map = 40%,  reduce = 6%
2016-04-12 18:24:14,554 Stage-1 map = 41%,  reduce = 6%
2016-04-12 18:24:20,592 Stage-1 map = 41%,  reduce = 7%
2016-04-12 18:24:23,612 Stage-1 map = 42%,  reduce = 7%
2016-04-12 18:24:26,632 Stage-1 map = 43%,  reduce = 7%
2016-04-12 18:24:29,652 Stage-1 map = 44%,  reduce = 7%
2016-04-12 18:24:35,690 Stage-1 map = 45%,  reduce = 7%
2016-04-12 18:24:41,727 Stage-1 map = 46%,  reduce = 7%
2016-04-12 18:24:44,747 Stage-1 map = 47%,  reduce = 7%
2016-04-12 18:24:47,767 Stage-1 map = 48%,  reduce = 8%
2016-04-12 18:24:53,804 Stage-1 map = 49%,  reduce = 8%
2016-04-12 18:24:56,825 Stage-1 map = 50%,  reduce = 8%
2016-04-12 18:24:59,849 Stage-1 map = 51%,  reduce = 8%
2016-04-12 18:25:01,863 Stage-1 map = 52%,  reduce = 8%
2016-04-12 18:25:07,899 Stage-1 map = 53%,  reduce = 8%
2016-04-12 18:25:13,936 Stage-1 map = 54%,  reduce = 9%
2016-04-12 18:25:16,962 Stage-1 map = 55%,  reduce = 9%
2016-04-12 18:25:23,000 Stage-1 map = 56%,  reduce = 9%
2016-04-12 18:25:26,020 Stage-1 map = 57%,  reduce = 9%
2016-04-12 18:25:29,040 Stage-1 map = 58%,  reduce = 9%
2016-04-12 18:25:35,078 Stage-1 map = 59%,  reduce = 9%
2016-04-12 18:25:41,115 Stage-1 map = 60%,  reduce = 10%
2016-04-12 18:25:44,135 Stage-1 map = 61%,  reduce = 10%
2016-04-12 18:25:47,155 Stage-1 map = 62%,  reduce = 10%
2016-04-12 18:25:53,192 Stage-1 map = 63%,  reduce = 10%
2016-04-12 18:25:59,230 Stage-1 map = 65%,  reduce = 10%
2016-04-12 18:26:05,268 Stage-1 map = 66%,  reduce = 10%
2016-04-12 18:26:08,288 Stage-1 map = 66%,  reduce = 11%
2016-04-12 18:26:11,307 Stage-1 map = 67%,  reduce = 11%
2016-04-12 18:26:14,327 Stage-1 map = 68%,  reduce = 11%
2016-04-12 18:26:20,364 Stage-1 map = 69%,  reduce = 11%
2016-04-12 18:26:23,384 Stage-1 map = 70%,  reduce = 11%
2016-04-12 18:26:29,421 Stage-1 map = 72%,  reduce = 11%
2016-04-12 18:26:35,458 Stage-1 map = 72%,  reduce = 12%
2016-04-12 18:26:38,478 Stage-1 map = 73%,  reduce = 12%
2016-04-12 18:26:41,498 Stage-1 map = 74%,  reduce = 12%
2016-04-12 18:26:44,517 Stage-1 map = 75%,  reduce = 12%
2016-04-12 18:26:50,555 Stage-1 map = 76%,  reduce = 12%
2016-04-12 18:26:53,575 Stage-1 map = 77%,  reduce = 12%
2016-04-12 18:26:59,611 Stage-1 map = 78%,  reduce = 13%
2016-04-12 18:27:05,646 Stage-1 map = 79%,  reduce = 13%
2016-04-12 18:27:11,682 Stage-1 map = 80%,  reduce = 13%
2016-04-12 18:27:14,701 Stage-1 map = 81%,  reduce = 13%
2016-04-12 18:27:17,720 Stage-1 map = 82%,  reduce = 13%
2016-04-12 18:27:20,740 Stage-1 map = 83%,  reduce = 13%
2016-04-12 18:27:26,775 Stage-1 map = 84%,  reduce = 14%
2016-04-12 18:27:32,812 Stage-1 map = 85%,  reduce = 14%
2016-04-12 18:27:35,831 Stage-1 map = 86%,  reduce = 14%
2016-04-12 18:27:41,868 Stage-1 map = 87%,  reduce = 14%
2016-04-12 18:27:44,887 Stage-1 map = 88%,  reduce = 14%
2016-04-12 18:27:47,906 Stage-1 map = 89%,  reduce = 14%
2016-04-12 18:27:53,942 Stage-1 map = 90%,  reduce = 14%
2016-04-12 18:27:56,962 Stage-1 map = 91%,  reduce = 15%
2016-04-12 18:28:06,014 Stage-1 map = 92%,  reduce = 15%
2016-04-12 18:28:09,034 Stage-1 map = 93%,  reduce = 15%
2016-04-12 18:28:12,053 Stage-1 map = 94%,  reduce = 15%
2016-04-12 18:28:15,073 Stage-1 map = 95%,  reduce = 15%
2016-04-12 18:28:18,092 Stage-1 map = 96%,  reduce = 15%
2016-04-12 18:28:21,112 Stage-1 map = 97%,  reduce = 16%
2016-04-12 18:28:29,161 Stage-1 map = 98%,  reduce = 16%
2016-04-12 18:28:32,181 Stage-1 map = 99%,  reduce = 16%
2016-04-12 18:28:38,218 Stage-1 map = 100%,  reduce = 16%
2016-04-12 18:28:44,254 Stage-1 map = 100%,  reduce = 21%
2016-04-12 18:28:47,273 Stage-1 map = 100%,  reduce = 30%
2016-04-12 18:28:50,293 Stage-1 map = 100%,  reduce = 37%
2016-04-12 18:28:53,312 Stage-1 map = 100%,  reduce = 41%
2016-04-12 18:28:56,334 Stage-1 map = 100%,  reduce = 47%
2016-04-12 18:28:59,357 Stage-1 map = 100%,  reduce = 50%
2016-04-12 18:29:05,395 Stage-1 map = 100%,  reduce = 51%
2016-04-12 18:29:08,416 Stage-1 map = 100%,  reduce = 54%
2016-04-12 18:29:11,437 Stage-1 map = 100%,  reduce = 58%
2016-04-12 18:29:14,458 Stage-1 map = 100%,  reduce = 59%
2016-04-12 18:29:23,518 Stage-1 map = 100%,  reduce = 61%
2016-04-12 18:29:26,540 Stage-1 map = 100%,  reduce = 64%
2016-04-12 18:29:29,562 Stage-1 map = 100%,  reduce = 66%
2016-04-12 18:29:41,637 Stage-1 map = 100%,  reduce = 67%
2016-04-12 18:29:44,659 Stage-1 map = 100%,  reduce = 79%
2016-04-12 18:29:47,680 Stage-1 map = 100%,  reduce = 87%
2016-04-12 18:29:50,702 Stage-1 map = 100%,  reduce = 92%
2016-04-12 18:29:53,724 Stage-1 map = 100%,  reduce = 99%
2016-04-12 18:29:56,745 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121820_0001
Loading data to table lineitem_tmp
2000000 Rows loaded to lineitem_tmp
OK
Time taken: 538.227 seconds
Total MapReduce jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 9
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121820_0002, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121820_0002
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121820_0002
2016-04-12 18:30:06,089 Stage-1 map = 0%,  reduce = 0%
2016-04-12 18:30:15,149 Stage-1 map = 3%,  reduce = 0%
2016-04-12 18:30:24,201 Stage-1 map = 5%,  reduce = 0%
2016-04-12 18:30:27,221 Stage-1 map = 7%,  reduce = 0%
2016-04-12 18:30:36,273 Stage-1 map = 8%,  reduce = 0%
2016-04-12 18:30:39,293 Stage-1 map = 9%,  reduce = 0%
2016-04-12 18:30:42,313 Stage-1 map = 10%,  reduce = 1%
2016-04-12 18:30:51,362 Stage-1 map = 12%,  reduce = 1%
2016-04-12 18:30:54,381 Stage-1 map = 13%,  reduce = 1%
2016-04-12 18:31:00,415 Stage-1 map = 13%,  reduce = 2%
2016-04-12 18:31:03,434 Stage-1 map = 14%,  reduce = 2%
2016-04-12 18:31:05,447 Stage-1 map = 16%,  reduce = 2%
2016-04-12 18:31:08,466 Stage-1 map = 17%,  reduce = 2%
2016-04-12 18:31:14,500 Stage-1 map = 18%,  reduce = 2%
2016-04-12 18:31:17,519 Stage-1 map = 19%,  reduce = 2%
2016-04-12 18:31:20,539 Stage-1 map = 20%,  reduce = 3%
2016-04-12 18:31:26,574 Stage-1 map = 21%,  reduce = 3%
2016-04-12 18:31:29,593 Stage-1 map = 23%,  reduce = 3%
2016-04-12 18:31:38,645 Stage-1 map = 24%,  reduce = 3%
2016-04-12 18:31:41,663 Stage-1 map = 26%,  reduce = 3%
2016-04-12 18:31:44,682 Stage-1 map = 27%,  reduce = 3%
2016-04-12 18:31:47,701 Stage-1 map = 27%,  reduce = 4%
2016-04-12 18:31:50,719 Stage-1 map = 28%,  reduce = 4%
2016-04-12 18:31:53,737 Stage-1 map = 29%,  reduce = 4%
2016-04-12 18:31:56,756 Stage-1 map = 30%,  reduce = 4%
2016-04-12 18:32:02,790 Stage-1 map = 31%,  reduce = 4%
2016-04-12 18:32:05,809 Stage-1 map = 33%,  reduce = 4%
2016-04-12 18:32:11,843 Stage-1 map = 33%,  reduce = 5%
2016-04-12 18:32:14,862 Stage-1 map = 34%,  reduce = 5%
2016-04-12 18:32:17,880 Stage-1 map = 36%,  reduce = 5%
2016-04-12 18:32:20,899 Stage-1 map = 37%,  reduce = 5%
2016-04-12 18:32:26,934 Stage-1 map = 38%,  reduce = 5%
2016-04-12 18:32:29,953 Stage-1 map = 39%,  reduce = 5%
2016-04-12 18:32:35,987 Stage-1 map = 40%,  reduce = 5%
2016-04-12 18:32:42,020 Stage-1 map = 41%,  reduce = 6%
2016-04-12 18:32:45,039 Stage-1 map = 43%,  reduce = 6%
2016-04-12 18:32:54,088 Stage-1 map = 44%,  reduce = 6%
2016-04-12 18:32:57,106 Stage-1 map = 46%,  reduce = 6%
2016-04-12 18:33:00,124 Stage-1 map = 47%,  reduce = 6%
2016-04-12 18:33:09,171 Stage-1 map = 49%,  reduce = 7%
2016-04-12 18:33:12,188 Stage-1 map = 50%,  reduce = 7%
2016-04-12 18:33:21,235 Stage-1 map = 52%,  reduce = 7%
2016-04-12 18:33:24,253 Stage-1 map = 53%,  reduce = 7%
2016-04-12 18:33:33,302 Stage-1 map = 55%,  reduce = 8%
2016-04-12 18:33:36,321 Stage-1 map = 57%,  reduce = 8%
2016-04-12 18:33:45,372 Stage-1 map = 58%,  reduce = 8%
2016-04-12 18:33:48,391 Stage-1 map = 59%,  reduce = 8%
2016-04-12 18:33:51,409 Stage-1 map = 60%,  reduce = 8%
2016-04-12 18:33:57,444 Stage-1 map = 61%,  reduce = 8%
2016-04-12 18:34:00,467 Stage-1 map = 63%,  reduce = 8%
2016-04-12 18:34:03,486 Stage-1 map = 63%,  reduce = 9%
2016-04-12 18:34:06,505 Stage-1 map = 64%,  reduce = 9%
2016-04-12 18:34:12,540 Stage-1 map = 66%,  reduce = 9%
2016-04-12 18:34:15,559 Stage-1 map = 67%,  reduce = 9%
2016-04-12 18:34:18,578 Stage-1 map = 67%,  reduce = 10%
2016-04-12 18:34:24,612 Stage-1 map = 69%,  reduce = 10%
2016-04-12 18:34:27,631 Stage-1 map = 71%,  reduce = 10%
2016-04-12 18:34:36,681 Stage-1 map = 72%,  reduce = 10%
2016-04-12 18:34:39,700 Stage-1 map = 73%,  reduce = 10%
2016-04-12 18:34:42,721 Stage-1 map = 74%,  reduce = 10%
2016-04-12 18:34:44,735 Stage-1 map = 74%,  reduce = 11%
2016-04-12 18:34:47,754 Stage-1 map = 75%,  reduce = 11%
2016-04-12 18:34:50,774 Stage-1 map = 76%,  reduce = 11%
2016-04-12 18:34:53,794 Stage-1 map = 77%,  reduce = 11%
2016-04-12 18:34:59,829 Stage-1 map = 78%,  reduce = 11%
2016-04-12 18:35:02,849 Stage-1 map = 79%,  reduce = 11%
2016-04-12 18:35:05,868 Stage-1 map = 81%,  reduce = 11%
2016-04-12 18:35:08,888 Stage-1 map = 81%,  reduce = 12%
2016-04-12 18:35:14,923 Stage-1 map = 83%,  reduce = 12%
2016-04-12 18:35:17,942 Stage-1 map = 84%,  reduce = 12%
2016-04-12 18:35:23,976 Stage-1 map = 85%,  reduce = 12%
2016-04-12 18:35:26,994 Stage-1 map = 87%,  reduce = 12%
2016-04-12 18:35:36,044 Stage-1 map = 89%,  reduce = 12%
2016-04-12 18:35:39,063 Stage-1 map = 90%,  reduce = 13%
2016-04-12 18:35:42,082 Stage-1 map = 91%,  reduce = 13%
2016-04-12 18:35:48,114 Stage-1 map = 92%,  reduce = 13%
2016-04-12 18:35:51,132 Stage-1 map = 94%,  reduce = 13%
2016-04-12 18:35:54,150 Stage-1 map = 94%,  reduce = 14%
2016-04-12 18:36:00,182 Stage-1 map = 95%,  reduce = 14%
2016-04-12 18:36:03,200 Stage-1 map = 97%,  reduce = 14%
2016-04-12 18:36:12,250 Stage-1 map = 99%,  reduce = 14%
2016-04-12 18:36:15,269 Stage-1 map = 100%,  reduce = 14%
2016-04-12 18:36:18,287 Stage-1 map = 100%,  reduce = 15%
2016-04-12 18:36:27,336 Stage-1 map = 100%,  reduce = 23%
2016-04-12 18:36:30,356 Stage-1 map = 100%,  reduce = 33%
2016-04-12 18:36:33,375 Stage-1 map = 100%,  reduce = 37%
2016-04-12 18:36:36,397 Stage-1 map = 100%,  reduce = 43%
2016-04-12 18:36:39,417 Stage-1 map = 100%,  reduce = 44%
2016-04-12 18:36:45,453 Stage-1 map = 100%,  reduce = 46%
2016-04-12 18:36:48,472 Stage-1 map = 100%,  reduce = 48%
2016-04-12 18:36:51,491 Stage-1 map = 100%,  reduce = 51%
2016-04-12 18:36:54,510 Stage-1 map = 100%,  reduce = 52%
2016-04-12 18:37:00,545 Stage-1 map = 100%,  reduce = 54%
2016-04-12 18:37:03,564 Stage-1 map = 100%,  reduce = 56%
2016-04-12 18:37:06,583 Stage-1 map = 100%,  reduce = 57%
2016-04-12 18:37:15,633 Stage-1 map = 100%,  reduce = 58%
2016-04-12 18:37:18,652 Stage-1 map = 100%,  reduce = 63%
2016-04-12 18:37:21,671 Stage-1 map = 100%,  reduce = 72%
2016-04-12 18:37:24,691 Stage-1 map = 100%,  reduce = 80%
2016-04-12 18:37:27,711 Stage-1 map = 100%,  reduce = 86%
2016-04-12 18:37:30,732 Stage-1 map = 100%,  reduce = 89%
2016-04-12 18:37:36,768 Stage-1 map = 100%,  reduce = 90%
2016-04-12 18:37:39,787 Stage-1 map = 100%,  reduce = 91%
2016-04-12 18:37:45,822 Stage-1 map = 100%,  reduce = 92%
2016-04-12 18:37:51,855 Stage-1 map = 100%,  reduce = 93%
2016-04-12 18:37:54,874 Stage-1 map = 100%,  reduce = 96%
2016-04-12 18:37:57,893 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121820_0002
Launching Job 2 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121820_0003, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121820_0003
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121820_0003
2016-04-12 18:38:06,466 Stage-2 map = 0%,  reduce = 0%
2016-04-12 18:38:15,501 Stage-2 map = 24%,  reduce = 0%
2016-04-12 18:38:24,538 Stage-2 map = 47%,  reduce = 8%
2016-04-12 18:38:30,564 Stage-2 map = 71%,  reduce = 8%
2016-04-12 18:38:33,579 Stage-2 map = 71%,  reduce = 16%
2016-04-12 18:38:36,593 Stage-2 map = 94%,  reduce = 16%
2016-04-12 18:38:39,607 Stage-2 map = 100%,  reduce = 27%
2016-04-12 18:38:48,643 Stage-2 map = 100%,  reduce = 90%
2016-04-12 18:38:51,657 Stage-2 map = 100%,  reduce = 100%
Ended Job = job_201604121820_0003
Launching Job 3 out of 3
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121820_0004, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121820_0004
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121820_0004
2016-04-12 18:39:00,133 Stage-3 map = 0%,  reduce = 0%
2016-04-12 18:39:03,146 Stage-3 map = 100%,  reduce = 0%
2016-04-12 18:39:12,183 Stage-3 map = 100%,  reduce = 100%
Ended Job = job_201604121820_0004
Loading data to table q17_small_quantity_order_revenue
1 Rows loaded to q17_small_quantity_order_revenue
OK
Time taken: 555.339 seconds
Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121840_1661080067.txt
OK
Time taken: 3.575 seconds
OK
Time taken: 0.065 seconds
FAILED: Error in metadata: MetaException(message:Got exception: org.apache.hadoop.ipc.RemoteException org.apache.hadoop.hdfs.server.namenode.SafeModeException: Cannot delete /user/hive/warehouse/q17_small_quantity_order_revenue. Name node is in safe mode.
The ratio of reported blocks 1.0000 has reached the threshold 0.9990. Safe mode will be turned off automatically in 24 seconds.
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.deleteInternal(FSNamesystem.java:1700)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.delete(FSNamesystem.java:1680)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.delete(NameNode.java:517)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:508)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:959)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:955)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:953)
)
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121840_113819201.txt
OK
Time taken: 2.803 seconds
OK
Time taken: 0.007 seconds
OK
Time taken: 0.009 seconds
OK
Time taken: 0.638 seconds
OK
Time taken: 0.212 seconds
OK
Time taken: 0.228 seconds
OK
Time taken: 0.056 seconds
OK
Time taken: 0.093 seconds
Total MapReduce jobs = 1
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 8
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121840_0001, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121840_0001
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121840_0001
2016-04-12 18:40:38,055 Stage-1 map = 0%,  reduce = 0%
2016-04-12 18:40:47,124 Stage-1 map = 1%,  reduce = 0%
2016-04-12 18:40:50,146 Stage-1 map = 2%,  reduce = 0%
2016-04-12 18:40:53,179 Stage-1 map = 3%,  reduce = 0%
2016-04-12 18:41:02,265 Stage-1 map = 4%,  reduce = 0%
2016-04-12 18:41:05,296 Stage-1 map = 6%,  reduce = 0%
2016-04-12 18:41:08,330 Stage-1 map = 7%,  reduce = 0%
2016-04-12 18:41:20,447 Stage-1 map = 8%,  reduce = 1%
2016-04-12 18:41:23,476 Stage-1 map = 9%,  reduce = 1%
2016-04-12 18:41:26,505 Stage-1 map = 10%,  reduce = 1%
2016-04-12 18:41:34,573 Stage-1 map = 11%,  reduce = 2%
2016-04-12 18:41:37,602 Stage-1 map = 12%,  reduce = 2%
2016-04-12 18:41:40,630 Stage-1 map = 13%,  reduce = 2%
2016-04-12 18:41:43,659 Stage-1 map = 14%,  reduce = 2%
2016-04-12 18:41:52,733 Stage-1 map = 16%,  reduce = 2%
2016-04-12 18:41:55,760 Stage-1 map = 17%,  reduce = 2%
2016-04-12 18:42:04,834 Stage-1 map = 18%,  reduce = 3%
2016-04-12 18:42:07,863 Stage-1 map = 19%,  reduce = 3%
2016-04-12 18:42:10,890 Stage-1 map = 21%,  reduce = 3%
2016-04-12 18:42:22,985 Stage-1 map = 22%,  reduce = 3%
2016-04-12 18:42:26,012 Stage-1 map = 23%,  reduce = 3%
2016-04-12 18:42:29,039 Stage-1 map = 24%,  reduce = 3%
2016-04-12 18:42:32,065 Stage-1 map = 24%,  reduce = 4%
2016-04-12 18:42:35,091 Stage-1 map = 25%,  reduce = 4%
2016-04-12 18:42:38,114 Stage-1 map = 26%,  reduce = 4%
2016-04-12 18:42:41,135 Stage-1 map = 27%,  reduce = 4%
2016-04-12 18:42:44,157 Stage-1 map = 28%,  reduce = 4%
2016-04-12 18:42:53,212 Stage-1 map = 29%,  reduce = 5%
2016-04-12 18:42:56,235 Stage-1 map = 31%,  reduce = 5%
2016-04-12 18:43:08,306 Stage-1 map = 33%,  reduce = 5%
2016-04-12 18:43:11,327 Stage-1 map = 34%,  reduce = 5%
2016-04-12 18:43:20,380 Stage-1 map = 35%,  reduce = 5%
2016-04-12 18:43:23,400 Stage-1 map = 37%,  reduce = 6%
2016-04-12 18:43:29,436 Stage-1 map = 38%,  reduce = 6%
2016-04-12 18:43:38,488 Stage-1 map = 39%,  reduce = 6%
2016-04-12 18:43:41,507 Stage-1 map = 40%,  reduce = 6%
2016-04-12 18:43:44,527 Stage-1 map = 41%,  reduce = 6%
2016-04-12 18:43:53,581 Stage-1 map = 42%,  reduce = 7%
2016-04-12 18:43:56,601 Stage-1 map = 43%,  reduce = 7%
2016-04-12 18:43:59,621 Stage-1 map = 44%,  reduce = 7%
2016-04-12 18:44:05,658 Stage-1 map = 45%,  reduce = 7%
2016-04-12 18:44:11,694 Stage-1 map = 46%,  reduce = 7%
2016-04-12 18:44:14,715 Stage-1 map = 47%,  reduce = 7%
2016-04-12 18:44:17,736 Stage-1 map = 48%,  reduce = 8%
2016-04-12 18:44:23,773 Stage-1 map = 49%,  reduce = 8%
2016-04-12 18:44:28,805 Stage-1 map = 50%,  reduce = 8%
2016-04-12 18:44:29,818 Stage-1 map = 51%,  reduce = 8%
2016-04-12 18:44:35,860 Stage-1 map = 52%,  reduce = 8%
2016-04-12 18:44:40,891 Stage-1 map = 53%,  reduce = 8%
2016-04-12 18:44:43,911 Stage-1 map = 54%,  reduce = 9%
2016-04-12 18:44:46,937 Stage-1 map = 55%,  reduce = 9%
2016-04-12 18:44:52,975 Stage-1 map = 56%,  reduce = 9%
2016-04-12 18:44:55,995 Stage-1 map = 57%,  reduce = 9%
2016-04-12 18:44:59,015 Stage-1 map = 58%,  reduce = 9%
2016-04-12 18:45:05,052 Stage-1 map = 59%,  reduce = 9%
2016-04-12 18:45:08,072 Stage-1 map = 60%,  reduce = 9%
2016-04-12 18:45:11,092 Stage-1 map = 60%,  reduce = 10%
2016-04-12 18:45:14,111 Stage-1 map = 61%,  reduce = 10%
2016-04-12 18:45:17,132 Stage-1 map = 62%,  reduce = 10%
2016-04-12 18:45:23,170 Stage-1 map = 63%,  reduce = 10%
2016-04-12 18:45:29,207 Stage-1 map = 64%,  reduce = 10%
2016-04-12 18:45:32,227 Stage-1 map = 65%,  reduce = 10%
2016-04-12 18:45:35,246 Stage-1 map = 66%,  reduce = 10%
2016-04-12 18:45:38,265 Stage-1 map = 66%,  reduce = 11%
2016-04-12 18:45:41,285 Stage-1 map = 67%,  reduce = 11%
2016-04-12 18:45:44,305 Stage-1 map = 68%,  reduce = 11%
2016-04-12 18:45:47,325 Stage-1 map = 69%,  reduce = 11%
2016-04-12 18:45:53,361 Stage-1 map = 70%,  reduce = 11%
2016-04-12 18:45:56,380 Stage-1 map = 71%,  reduce = 11%
2016-04-12 18:45:59,399 Stage-1 map = 72%,  reduce = 11%
2016-04-12 18:46:05,435 Stage-1 map = 72%,  reduce = 12%
2016-04-12 18:46:08,454 Stage-1 map = 73%,  reduce = 12%
2016-04-12 18:46:11,473 Stage-1 map = 74%,  reduce = 12%
2016-04-12 18:46:14,492 Stage-1 map = 75%,  reduce = 12%
2016-04-12 18:46:20,528 Stage-1 map = 76%,  reduce = 12%
2016-04-12 18:46:23,547 Stage-1 map = 77%,  reduce = 12%
2016-04-12 18:46:26,566 Stage-1 map = 77%,  reduce = 13%
2016-04-12 18:46:29,585 Stage-1 map = 78%,  reduce = 13%
2016-04-12 18:46:35,619 Stage-1 map = 79%,  reduce = 13%
2016-04-12 18:46:41,655 Stage-1 map = 80%,  reduce = 13%
2016-04-12 18:46:47,690 Stage-1 map = 81%,  reduce = 13%
2016-04-12 18:46:50,711 Stage-1 map = 82%,  reduce = 13%
2016-04-12 18:46:53,730 Stage-1 map = 83%,  reduce = 13%
2016-04-12 18:46:56,750 Stage-1 map = 84%,  reduce = 13%
2016-04-12 18:46:59,770 Stage-1 map = 84%,  reduce = 14%
2016-04-12 18:47:02,789 Stage-1 map = 85%,  reduce = 14%
2016-04-12 18:47:05,808 Stage-1 map = 86%,  reduce = 14%
2016-04-12 18:47:11,844 Stage-1 map = 87%,  reduce = 14%
2016-04-12 18:47:14,863 Stage-1 map = 88%,  reduce = 14%
2016-04-12 18:47:17,883 Stage-1 map = 89%,  reduce = 14%
2016-04-12 18:47:23,919 Stage-1 map = 90%,  reduce = 14%
2016-04-12 18:47:26,938 Stage-1 map = 91%,  reduce = 15%
2016-04-12 18:47:35,990 Stage-1 map = 93%,  reduce = 15%
2016-04-12 18:47:42,026 Stage-1 map = 94%,  reduce = 15%
2016-04-12 18:47:45,046 Stage-1 map = 95%,  reduce = 15%
2016-04-12 18:47:48,066 Stage-1 map = 96%,  reduce = 15%
2016-04-12 18:47:51,087 Stage-1 map = 96%,  reduce = 16%
2016-04-12 18:47:54,107 Stage-1 map = 97%,  reduce = 16%
2016-04-12 18:47:56,122 Stage-1 map = 98%,  reduce = 16%
2016-04-12 18:48:03,165 Stage-1 map = 99%,  reduce = 16%
2016-04-12 18:48:06,185 Stage-1 map = 100%,  reduce = 16%
2016-04-12 18:48:14,236 Stage-1 map = 100%,  reduce = 17%
2016-04-12 18:48:17,256 Stage-1 map = 100%,  reduce = 29%
2016-04-12 18:48:20,276 Stage-1 map = 100%,  reduce = 35%
2016-04-12 18:48:23,296 Stage-1 map = 100%,  reduce = 40%
2016-04-12 18:48:26,316 Stage-1 map = 100%,  reduce = 45%
2016-04-12 18:48:29,340 Stage-1 map = 100%,  reduce = 50%
2016-04-12 18:48:38,398 Stage-1 map = 100%,  reduce = 52%
2016-04-12 18:48:41,419 Stage-1 map = 100%,  reduce = 56%
2016-04-12 18:48:44,441 Stage-1 map = 100%,  reduce = 59%
2016-04-12 18:48:56,518 Stage-1 map = 100%,  reduce = 62%
2016-04-12 18:48:59,539 Stage-1 map = 100%,  reduce = 65%
2016-04-12 18:49:02,560 Stage-1 map = 100%,  reduce = 66%
2016-04-12 18:49:14,635 Stage-1 map = 100%,  reduce = 67%
2016-04-12 18:49:17,657 Stage-1 map = 100%,  reduce = 79%
2016-04-12 18:49:20,678 Stage-1 map = 100%,  reduce = 87%
2016-04-12 18:49:23,700 Stage-1 map = 100%,  reduce = 92%
2016-04-12 18:49:26,721 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121840_0001
Loading data to table lineitem_tmp
2000000 Rows loaded to lineitem_tmp
OK
Time taken: 538.104 seconds
Total MapReduce jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 9
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121840_0002, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121840_0002
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121840_0002
2016-04-12 18:49:36,099 Stage-1 map = 0%,  reduce = 0%
2016-04-12 18:49:45,147 Stage-1 map = 3%,  reduce = 0%
2016-04-12 18:49:54,216 Stage-1 map = 5%,  reduce = 0%
2016-04-12 18:49:57,237 Stage-1 map = 7%,  reduce = 0%
2016-04-12 18:50:06,289 Stage-1 map = 8%,  reduce = 0%
2016-04-12 18:50:09,309 Stage-1 map = 9%,  reduce = 0%
2016-04-12 18:50:11,324 Stage-1 map = 10%,  reduce = 1%
2016-04-12 18:50:20,380 Stage-1 map = 11%,  reduce = 1%
2016-04-12 18:50:21,389 Stage-1 map = 12%,  reduce = 1%
2016-04-12 18:50:23,402 Stage-1 map = 13%,  reduce = 1%
2016-04-12 18:50:30,440 Stage-1 map = 13%,  reduce = 2%
2016-04-12 18:50:32,453 Stage-1 map = 14%,  reduce = 2%
2016-04-12 18:50:33,461 Stage-1 map = 15%,  reduce = 2%
2016-04-12 18:50:35,475 Stage-1 map = 16%,  reduce = 2%
2016-04-12 18:50:36,484 Stage-1 map = 17%,  reduce = 2%
2016-04-12 18:50:44,529 Stage-1 map = 19%,  reduce = 2%
2016-04-12 18:50:47,547 Stage-1 map = 20%,  reduce = 2%
2016-04-12 18:50:50,566 Stage-1 map = 20%,  reduce = 3%
2016-04-12 18:50:56,602 Stage-1 map = 22%,  reduce = 3%
2016-04-12 18:50:59,620 Stage-1 map = 23%,  reduce = 3%
2016-04-12 18:51:08,669 Stage-1 map = 25%,  reduce = 3%
2016-04-12 18:51:11,688 Stage-1 map = 27%,  reduce = 3%
2016-04-12 18:51:20,741 Stage-1 map = 29%,  reduce = 4%
2016-04-12 18:51:23,759 Stage-1 map = 30%,  reduce = 4%
2016-04-12 18:51:32,807 Stage-1 map = 32%,  reduce = 4%
2016-04-12 18:51:35,826 Stage-1 map = 33%,  reduce = 4%
2016-04-12 18:51:41,858 Stage-1 map = 33%,  reduce = 5%
2016-04-12 18:51:44,874 Stage-1 map = 35%,  reduce = 5%
2016-04-12 18:51:47,890 Stage-1 map = 37%,  reduce = 5%
2016-04-12 18:51:56,937 Stage-1 map = 38%,  reduce = 5%
2016-04-12 18:51:59,955 Stage-1 map = 39%,  reduce = 5%
2016-04-12 18:52:02,973 Stage-1 map = 40%,  reduce = 5%
2016-04-12 18:52:12,022 Stage-1 map = 41%,  reduce = 6%
2016-04-12 18:52:15,040 Stage-1 map = 43%,  reduce = 6%
2016-04-12 18:52:24,089 Stage-1 map = 44%,  reduce = 6%
2016-04-12 18:52:27,107 Stage-1 map = 46%,  reduce = 6%
2016-04-12 18:52:30,126 Stage-1 map = 47%,  reduce = 6%
2016-04-12 18:52:33,145 Stage-1 map = 47%,  reduce = 7%
2016-04-12 18:52:36,162 Stage-1 map = 48%,  reduce = 7%
2016-04-12 18:52:39,180 Stage-1 map = 49%,  reduce = 7%
2016-04-12 18:52:42,198 Stage-1 map = 50%,  reduce = 7%
2016-04-12 18:52:48,231 Stage-1 map = 51%,  reduce = 7%
2016-04-12 18:52:51,249 Stage-1 map = 53%,  reduce = 7%
2016-04-12 18:53:00,297 Stage-1 map = 53%,  reduce = 8%
2016-04-12 18:53:03,315 Stage-1 map = 55%,  reduce = 8%
2016-04-12 18:53:06,333 Stage-1 map = 57%,  reduce = 8%
2016-04-12 18:53:15,380 Stage-1 map = 59%,  reduce = 8%
2016-04-12 18:53:18,399 Stage-1 map = 60%,  reduce = 8%
2016-04-12 18:53:24,433 Stage-1 map = 60%,  reduce = 9%
2016-04-12 18:53:27,451 Stage-1 map = 62%,  reduce = 9%
2016-04-12 18:53:30,472 Stage-1 map = 63%,  reduce = 9%
2016-04-12 18:53:36,506 Stage-1 map = 64%,  reduce = 9%
2016-04-12 18:53:39,524 Stage-1 map = 65%,  reduce = 9%
2016-04-12 18:53:42,541 Stage-1 map = 67%,  reduce = 9%
2016-04-12 18:53:48,574 Stage-1 map = 68%,  reduce = 10%
2016-04-12 18:53:51,592 Stage-1 map = 69%,  reduce = 10%
2016-04-12 18:53:54,610 Stage-1 map = 70%,  reduce = 10%
2016-04-12 18:54:00,643 Stage-1 map = 71%,  reduce = 10%
2016-04-12 18:54:03,661 Stage-1 map = 72%,  reduce = 10%
2016-04-12 18:54:08,690 Stage-1 map = 73%,  reduce = 10%
2016-04-12 18:54:15,727 Stage-1 map = 74%,  reduce = 10%
2016-04-12 18:54:17,740 Stage-1 map = 75%,  reduce = 11%
2016-04-12 18:54:18,748 Stage-1 map = 76%,  reduce = 11%
2016-04-12 18:54:21,767 Stage-1 map = 77%,  reduce = 11%
2016-04-12 18:54:26,796 Stage-1 map = 78%,  reduce = 11%
2016-04-12 18:54:29,814 Stage-1 map = 79%,  reduce = 11%
2016-04-12 18:54:32,832 Stage-1 map = 80%,  reduce = 11%
2016-04-12 18:54:38,866 Stage-1 map = 81%,  reduce = 12%
2016-04-12 18:54:41,884 Stage-1 map = 83%,  reduce = 12%
2016-04-12 18:54:50,933 Stage-1 map = 84%,  reduce = 12%
2016-04-12 18:54:53,951 Stage-1 map = 86%,  reduce = 12%
2016-04-12 18:54:56,969 Stage-1 map = 87%,  reduce = 12%
2016-04-12 18:55:03,003 Stage-1 map = 88%,  reduce = 13%
2016-04-12 18:55:06,022 Stage-1 map = 89%,  reduce = 13%
2016-04-12 18:55:09,041 Stage-1 map = 90%,  reduce = 13%
2016-04-12 18:55:15,075 Stage-1 map = 91%,  reduce = 13%
2016-04-12 18:55:18,094 Stage-1 map = 93%,  reduce = 13%
2016-04-12 18:55:24,128 Stage-1 map = 93%,  reduce = 14%
2016-04-12 18:55:27,147 Stage-1 map = 94%,  reduce = 14%
2016-04-12 18:55:30,166 Stage-1 map = 96%,  reduce = 14%
2016-04-12 18:55:33,185 Stage-1 map = 97%,  reduce = 14%
2016-04-12 18:55:39,219 Stage-1 map = 98%,  reduce = 14%
2016-04-12 18:55:42,238 Stage-1 map = 100%,  reduce = 14%
2016-04-12 18:55:48,273 Stage-1 map = 100%,  reduce = 19%
2016-04-12 18:55:51,292 Stage-1 map = 100%,  reduce = 23%
2016-04-12 18:55:54,311 Stage-1 map = 100%,  reduce = 33%
2016-04-12 18:55:57,330 Stage-1 map = 100%,  reduce = 37%
2016-04-12 18:56:00,353 Stage-1 map = 100%,  reduce = 41%
2016-04-12 18:56:03,373 Stage-1 map = 100%,  reduce = 44%
2016-04-12 18:56:09,409 Stage-1 map = 100%,  reduce = 46%
2016-04-12 18:56:12,428 Stage-1 map = 100%,  reduce = 48%
2016-04-12 18:56:15,448 Stage-1 map = 100%,  reduce = 51%
2016-04-12 18:56:18,467 Stage-1 map = 100%,  reduce = 52%
2016-04-12 18:56:24,503 Stage-1 map = 100%,  reduce = 54%
2016-04-12 18:56:27,522 Stage-1 map = 100%,  reduce = 56%
2016-04-12 18:56:30,542 Stage-1 map = 100%,  reduce = 57%
2016-04-12 18:56:36,577 Stage-1 map = 100%,  reduce = 58%
2016-04-12 18:56:42,613 Stage-1 map = 100%,  reduce = 63%
2016-04-12 18:56:45,633 Stage-1 map = 100%,  reduce = 72%
2016-04-12 18:56:48,653 Stage-1 map = 100%,  reduce = 80%
2016-04-12 18:56:51,673 Stage-1 map = 100%,  reduce = 86%
2016-04-12 18:56:54,693 Stage-1 map = 100%,  reduce = 89%
2016-04-12 18:57:00,729 Stage-1 map = 100%,  reduce = 90%
2016-04-12 18:57:03,751 Stage-1 map = 100%,  reduce = 91%
2016-04-12 18:57:09,784 Stage-1 map = 100%,  reduce = 92%
2016-04-12 18:57:15,818 Stage-1 map = 100%,  reduce = 93%
2016-04-12 18:57:18,837 Stage-1 map = 100%,  reduce = 96%
2016-04-12 18:57:20,850 Stage-1 map = 100%,  reduce = 97%
2016-04-12 18:57:21,859 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121840_0002
Launching Job 2 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121840_0003, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121840_0003
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121840_0003
2016-04-12 18:57:30,433 Stage-2 map = 0%,  reduce = 0%
2016-04-12 18:57:39,467 Stage-2 map = 24%,  reduce = 0%
2016-04-12 18:57:48,503 Stage-2 map = 47%,  reduce = 8%
2016-04-12 18:57:54,529 Stage-2 map = 71%,  reduce = 8%
2016-04-12 18:57:57,545 Stage-2 map = 71%,  reduce = 16%
2016-04-12 18:58:00,559 Stage-2 map = 94%,  reduce = 16%
2016-04-12 18:58:03,574 Stage-2 map = 100%,  reduce = 31%
2016-04-12 18:58:12,611 Stage-2 map = 100%,  reduce = 89%
2016-04-12 18:58:15,626 Stage-2 map = 100%,  reduce = 100%
Ended Job = job_201604121840_0003
Launching Job 3 out of 3
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121840_0004, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121840_0004
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121840_0004
2016-04-12 18:58:24,123 Stage-3 map = 0%,  reduce = 0%
2016-04-12 18:58:27,136 Stage-3 map = 100%,  reduce = 0%
2016-04-12 18:58:36,173 Stage-3 map = 100%,  reduce = 100%
Ended Job = job_201604121840_0004
Loading data to table q17_small_quantity_order_revenue
1 Rows loaded to q17_small_quantity_order_revenue
OK
Time taken: 549.32 seconds
Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121859_1659399722.txt
OK
Time taken: 3.365 seconds
OK
Time taken: 0.065 seconds
FAILED: Error in metadata: MetaException(message:Got exception: org.apache.hadoop.ipc.RemoteException org.apache.hadoop.hdfs.server.namenode.SafeModeException: Cannot delete /user/hive/warehouse/q17_small_quantity_order_revenue. Name node is in safe mode.
The ratio of reported blocks 1.0000 has reached the threshold 0.9990. Safe mode will be turned off automatically in 24 seconds.
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.deleteInternal(FSNamesystem.java:1700)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.delete(FSNamesystem.java:1680)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.delete(NameNode.java:517)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:508)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:959)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:955)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:953)
)
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121859_96607268.txt
OK
Time taken: 2.904 seconds
OK
Time taken: 0.007 seconds
OK
Time taken: 0.012 seconds
OK
Time taken: 0.622 seconds
OK
Time taken: 0.197 seconds
OK
Time taken: 0.041 seconds
OK
Time taken: 0.033 seconds
OK
Time taken: 0.085 seconds
Total MapReduce jobs = 1
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 8
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121859_0001, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121859_0001
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121859_0001
2016-04-12 19:00:01,334 Stage-1 map = 0%,  reduce = 0%
2016-04-12 19:00:13,423 Stage-1 map = 1%,  reduce = 0%
2016-04-12 19:00:16,459 Stage-1 map = 2%,  reduce = 0%
2016-04-12 19:00:19,492 Stage-1 map = 3%,  reduce = 0%
2016-04-12 19:00:25,550 Stage-1 map = 4%,  reduce = 0%
2016-04-12 19:00:28,582 Stage-1 map = 5%,  reduce = 0%
2016-04-12 19:00:34,643 Stage-1 map = 6%,  reduce = 0%
2016-04-12 19:00:37,677 Stage-1 map = 7%,  reduce = 0%
2016-04-12 19:00:43,737 Stage-1 map = 7%,  reduce = 1%
2016-04-12 19:00:46,765 Stage-1 map = 8%,  reduce = 1%
2016-04-12 19:00:49,793 Stage-1 map = 9%,  reduce = 1%
2016-04-12 19:00:52,821 Stage-1 map = 10%,  reduce = 1%
2016-04-12 19:00:58,874 Stage-1 map = 11%,  reduce = 1%
2016-04-12 19:01:01,902 Stage-1 map = 12%,  reduce = 2%
2016-04-12 19:01:04,931 Stage-1 map = 13%,  reduce = 2%
2016-04-12 19:01:10,982 Stage-1 map = 14%,  reduce = 2%
2016-04-12 19:01:17,032 Stage-1 map = 15%,  reduce = 2%
2016-04-12 19:01:20,059 Stage-1 map = 16%,  reduce = 2%
2016-04-12 19:01:23,086 Stage-1 map = 17%,  reduce = 2%
2016-04-12 19:01:29,137 Stage-1 map = 18%,  reduce = 2%
2016-04-12 19:01:32,163 Stage-1 map = 18%,  reduce = 3%
2016-04-12 19:01:35,190 Stage-1 map = 20%,  reduce = 3%
2016-04-12 19:01:41,239 Stage-1 map = 21%,  reduce = 3%
2016-04-12 19:01:47,288 Stage-1 map = 22%,  reduce = 3%
2016-04-12 19:01:50,315 Stage-1 map = 23%,  reduce = 3%
2016-04-12 19:01:53,343 Stage-1 map = 24%,  reduce = 3%
2016-04-12 19:01:59,391 Stage-1 map = 25%,  reduce = 4%
2016-04-12 19:02:05,432 Stage-1 map = 26%,  reduce = 4%
2016-04-12 19:02:08,455 Stage-1 map = 27%,  reduce = 4%
2016-04-12 19:02:11,478 Stage-1 map = 28%,  reduce = 4%
2016-04-12 19:02:16,512 Stage-1 map = 29%,  reduce = 4%
2016-04-12 19:02:19,533 Stage-1 map = 30%,  reduce = 4%
2016-04-12 19:02:22,555 Stage-1 map = 31%,  reduce = 5%
2016-04-12 19:02:31,611 Stage-1 map = 32%,  reduce = 5%
2016-04-12 19:02:34,632 Stage-1 map = 34%,  reduce = 5%
2016-04-12 19:02:43,686 Stage-1 map = 35%,  reduce = 5%
2016-04-12 19:02:46,705 Stage-1 map = 36%,  reduce = 5%
2016-04-12 19:02:49,725 Stage-1 map = 36%,  reduce = 6%
2016-04-12 19:02:55,760 Stage-1 map = 37%,  reduce = 6%
2016-04-12 19:02:58,780 Stage-1 map = 39%,  reduce = 6%
2016-04-12 19:03:01,800 Stage-1 map = 40%,  reduce = 6%
2016-04-12 19:03:13,869 Stage-1 map = 41%,  reduce = 7%
2016-04-12 19:03:16,889 Stage-1 map = 42%,  reduce = 7%
2016-04-12 19:03:22,925 Stage-1 map = 43%,  reduce = 7%
2016-04-12 19:03:25,945 Stage-1 map = 44%,  reduce = 7%
2016-04-12 19:03:31,983 Stage-1 map = 46%,  reduce = 7%
2016-04-12 19:03:38,021 Stage-1 map = 47%,  reduce = 7%
2016-04-12 19:03:44,059 Stage-1 map = 48%,  reduce = 8%
2016-04-12 19:03:50,096 Stage-1 map = 49%,  reduce = 8%
2016-04-12 19:03:53,116 Stage-1 map = 50%,  reduce = 8%
2016-04-12 19:03:56,137 Stage-1 map = 51%,  reduce = 8%
2016-04-12 19:04:02,174 Stage-1 map = 53%,  reduce = 8%
2016-04-12 19:04:11,229 Stage-1 map = 54%,  reduce = 9%
2016-04-12 19:04:17,267 Stage-1 map = 56%,  reduce = 9%
2016-04-12 19:04:23,304 Stage-1 map = 57%,  reduce = 9%
2016-04-12 19:04:26,324 Stage-1 map = 58%,  reduce = 9%
2016-04-12 19:04:32,360 Stage-1 map = 59%,  reduce = 9%
2016-04-12 19:04:35,381 Stage-1 map = 60%,  reduce = 9%
2016-04-12 19:04:41,418 Stage-1 map = 61%,  reduce = 10%
2016-04-12 19:04:44,438 Stage-1 map = 62%,  reduce = 10%
2016-04-12 19:04:47,459 Stage-1 map = 63%,  reduce = 10%
2016-04-12 19:04:53,497 Stage-1 map = 64%,  reduce = 10%
2016-04-12 19:04:59,535 Stage-1 map = 65%,  reduce = 11%
2016-04-12 19:05:02,553 Stage-1 map = 66%,  reduce = 11%
2016-04-12 19:05:05,572 Stage-1 map = 67%,  reduce = 11%
2016-04-12 19:05:11,608 Stage-1 map = 68%,  reduce = 11%
2016-04-12 19:05:17,645 Stage-1 map = 69%,  reduce = 11%
2016-04-12 19:05:20,665 Stage-1 map = 70%,  reduce = 11%
2016-04-12 19:05:23,685 Stage-1 map = 71%,  reduce = 11%
2016-04-12 19:05:26,704 Stage-1 map = 72%,  reduce = 11%
2016-04-12 19:05:29,725 Stage-1 map = 72%,  reduce = 12%
2016-04-12 19:05:32,744 Stage-1 map = 73%,  reduce = 12%
2016-04-12 19:05:35,765 Stage-1 map = 74%,  reduce = 12%
2016-04-12 19:05:40,796 Stage-1 map = 75%,  reduce = 12%
2016-04-12 19:05:46,833 Stage-1 map = 76%,  reduce = 12%
2016-04-12 19:05:47,842 Stage-1 map = 77%,  reduce = 12%
2016-04-12 19:05:52,874 Stage-1 map = 78%,  reduce = 12%
2016-04-12 19:05:55,893 Stage-1 map = 78%,  reduce = 13%
2016-04-12 19:06:01,929 Stage-1 map = 79%,  reduce = 13%
2016-04-12 19:06:04,949 Stage-1 map = 80%,  reduce = 13%
2016-04-12 19:06:07,968 Stage-1 map = 81%,  reduce = 13%
2016-04-12 19:06:14,009 Stage-1 map = 82%,  reduce = 13%
2016-04-12 19:06:17,029 Stage-1 map = 83%,  reduce = 13%
2016-04-12 19:06:20,048 Stage-1 map = 84%,  reduce = 14%
2016-04-12 19:06:29,102 Stage-1 map = 85%,  reduce = 14%
2016-04-12 19:06:32,121 Stage-1 map = 86%,  reduce = 14%
2016-04-12 19:06:35,141 Stage-1 map = 87%,  reduce = 14%
2016-04-12 19:06:41,179 Stage-1 map = 88%,  reduce = 14%
2016-04-12 19:06:44,199 Stage-1 map = 89%,  reduce = 14%
2016-04-12 19:06:50,235 Stage-1 map = 90%,  reduce = 15%
2016-04-12 19:06:53,255 Stage-1 map = 91%,  reduce = 15%
2016-04-12 19:07:02,309 Stage-1 map = 92%,  reduce = 15%
2016-04-12 19:07:05,329 Stage-1 map = 94%,  reduce = 15%
2016-04-12 19:07:08,349 Stage-1 map = 95%,  reduce = 15%
2016-04-12 19:07:17,404 Stage-1 map = 96%,  reduce = 16%
2016-04-12 19:07:20,424 Stage-1 map = 97%,  reduce = 16%
2016-04-12 19:07:23,444 Stage-1 map = 98%,  reduce = 16%
2016-04-12 19:07:32,499 Stage-1 map = 99%,  reduce = 16%
2016-04-12 19:07:35,519 Stage-1 map = 100%,  reduce = 16%
2016-04-12 19:07:44,574 Stage-1 map = 100%,  reduce = 17%
2016-04-12 19:07:47,595 Stage-1 map = 100%,  reduce = 25%
2016-04-12 19:07:50,614 Stage-1 map = 100%,  reduce = 35%
2016-04-12 19:07:53,634 Stage-1 map = 100%,  reduce = 39%
2016-04-12 19:07:56,653 Stage-1 map = 100%,  reduce = 45%
2016-04-12 19:07:59,677 Stage-1 map = 100%,  reduce = 50%
2016-04-12 19:08:08,733 Stage-1 map = 100%,  reduce = 52%
2016-04-12 19:08:11,754 Stage-1 map = 100%,  reduce = 57%
2016-04-12 19:08:14,776 Stage-1 map = 100%,  reduce = 59%
2016-04-12 19:08:26,853 Stage-1 map = 100%,  reduce = 63%
2016-04-12 19:08:29,874 Stage-1 map = 100%,  reduce = 66%
2016-04-12 19:08:44,968 Stage-1 map = 100%,  reduce = 71%
2016-04-12 19:08:47,990 Stage-1 map = 100%,  reduce = 80%
2016-04-12 19:08:51,012 Stage-1 map = 100%,  reduce = 88%
2016-04-12 19:08:54,034 Stage-1 map = 100%,  reduce = 94%
2016-04-12 19:08:57,055 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121859_0001
Loading data to table lineitem_tmp
2000000 Rows loaded to lineitem_tmp
OK
Time taken: 544.625 seconds
Total MapReduce jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 9
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121859_0002, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121859_0002
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121859_0002
2016-04-12 19:09:05,477 Stage-1 map = 0%,  reduce = 0%
2016-04-12 19:09:14,522 Stage-1 map = 3%,  reduce = 0%
2016-04-12 19:09:23,573 Stage-1 map = 5%,  reduce = 0%
2016-04-12 19:09:26,592 Stage-1 map = 7%,  reduce = 0%
2016-04-12 19:09:35,645 Stage-1 map = 8%,  reduce = 0%
2016-04-12 19:09:38,664 Stage-1 map = 9%,  reduce = 0%
2016-04-12 19:09:41,684 Stage-1 map = 10%,  reduce = 1%
2016-04-12 19:09:50,734 Stage-1 map = 12%,  reduce = 1%
2016-04-12 19:09:53,753 Stage-1 map = 13%,  reduce = 1%
2016-04-12 19:09:59,788 Stage-1 map = 13%,  reduce = 2%
2016-04-12 19:10:02,807 Stage-1 map = 15%,  reduce = 2%
2016-04-12 19:10:05,827 Stage-1 map = 17%,  reduce = 2%
2016-04-12 19:10:14,880 Stage-1 map = 19%,  reduce = 2%
2016-04-12 19:10:17,900 Stage-1 map = 20%,  reduce = 2%
2016-04-12 19:10:20,921 Stage-1 map = 20%,  reduce = 3%
2016-04-12 19:10:26,956 Stage-1 map = 22%,  reduce = 3%
2016-04-12 19:10:29,976 Stage-1 map = 23%,  reduce = 3%
2016-04-12 19:10:39,027 Stage-1 map = 25%,  reduce = 3%
2016-04-12 19:10:42,047 Stage-1 map = 27%,  reduce = 3%
2016-04-12 19:10:48,087 Stage-1 map = 27%,  reduce = 4%
2016-04-12 19:10:51,105 Stage-1 map = 29%,  reduce = 4%
2016-04-12 19:10:54,129 Stage-1 map = 30%,  reduce = 4%
2016-04-12 19:11:03,178 Stage-1 map = 32%,  reduce = 4%
2016-04-12 19:11:06,196 Stage-1 map = 33%,  reduce = 4%
2016-04-12 19:11:12,230 Stage-1 map = 33%,  reduce = 5%
2016-04-12 19:11:15,249 Stage-1 map = 35%,  reduce = 5%
2016-04-12 19:11:18,266 Stage-1 map = 37%,  reduce = 5%
2016-04-12 19:11:27,316 Stage-1 map = 38%,  reduce = 5%
2016-04-12 19:11:30,334 Stage-1 map = 39%,  reduce = 5%
2016-04-12 19:11:33,352 Stage-1 map = 40%,  reduce = 5%
2016-04-12 19:11:39,385 Stage-1 map = 40%,  reduce = 6%
2016-04-12 19:11:42,404 Stage-1 map = 41%,  reduce = 6%
2016-04-12 19:11:45,422 Stage-1 map = 43%,  reduce = 6%
2016-04-12 19:11:53,466 Stage-1 map = 44%,  reduce = 6%
2016-04-12 19:11:56,486 Stage-1 map = 46%,  reduce = 6%
2016-04-12 19:11:59,505 Stage-1 map = 47%,  reduce = 6%
2016-04-12 19:12:05,538 Stage-1 map = 47%,  reduce = 7%
2016-04-12 19:12:08,555 Stage-1 map = 49%,  reduce = 7%
2016-04-12 19:12:11,575 Stage-1 map = 50%,  reduce = 7%
2016-04-12 19:12:20,623 Stage-1 map = 52%,  reduce = 7%
2016-04-12 19:12:23,641 Stage-1 map = 53%,  reduce = 7%
2016-04-12 19:12:32,690 Stage-1 map = 54%,  reduce = 8%
2016-04-12 19:12:35,708 Stage-1 map = 56%,  reduce = 8%
2016-04-12 19:12:38,727 Stage-1 map = 57%,  reduce = 8%
2016-04-12 19:12:47,777 Stage-1 map = 59%,  reduce = 8%
2016-04-12 19:12:50,797 Stage-1 map = 60%,  reduce = 8%
2016-04-12 19:12:56,831 Stage-1 map = 61%,  reduce = 9%
2016-04-12 19:12:59,850 Stage-1 map = 63%,  reduce = 9%
2016-04-12 19:13:08,902 Stage-1 map = 64%,  reduce = 9%
2016-04-12 19:13:11,920 Stage-1 map = 66%,  reduce = 9%
2016-04-12 19:13:14,939 Stage-1 map = 67%,  reduce = 9%
2016-04-12 19:13:17,957 Stage-1 map = 67%,  reduce = 10%
2016-04-12 19:13:20,976 Stage-1 map = 68%,  reduce = 10%
2016-04-12 19:13:23,994 Stage-1 map = 69%,  reduce = 10%
2016-04-12 19:13:27,013 Stage-1 map = 70%,  reduce = 10%
2016-04-12 19:13:33,047 Stage-1 map = 71%,  reduce = 10%
2016-04-12 19:13:36,066 Stage-1 map = 73%,  reduce = 10%
2016-04-12 19:13:45,117 Stage-1 map = 73%,  reduce = 11%
2016-04-12 19:13:48,136 Stage-1 map = 74%,  reduce = 11%
2016-04-12 19:13:51,154 Stage-1 map = 76%,  reduce = 11%
2016-04-12 19:13:54,172 Stage-1 map = 77%,  reduce = 11%
2016-04-12 19:14:03,221 Stage-1 map = 79%,  reduce = 11%
2016-04-12 19:14:06,240 Stage-1 map = 80%,  reduce = 11%
2016-04-12 19:14:09,259 Stage-1 map = 80%,  reduce = 12%
2016-04-12 19:14:15,293 Stage-1 map = 82%,  reduce = 12%
2016-04-12 19:14:18,311 Stage-1 map = 83%,  reduce = 12%
2016-04-12 19:14:27,361 Stage-1 map = 85%,  reduce = 12%
2016-04-12 19:14:30,381 Stage-1 map = 87%,  reduce = 12%
2016-04-12 19:14:39,433 Stage-1 map = 89%,  reduce = 13%
2016-04-12 19:14:42,453 Stage-1 map = 90%,  reduce = 13%
2016-04-12 19:14:51,506 Stage-1 map = 92%,  reduce = 13%
2016-04-12 19:14:54,526 Stage-1 map = 93%,  reduce = 13%
2016-04-12 19:15:03,578 Stage-1 map = 94%,  reduce = 14%
2016-04-12 19:15:06,598 Stage-1 map = 96%,  reduce = 14%
2016-04-12 19:15:09,618 Stage-1 map = 97%,  reduce = 14%
2016-04-12 19:15:15,654 Stage-1 map = 98%,  reduce = 14%
2016-04-12 19:15:18,674 Stage-1 map = 99%,  reduce = 14%
2016-04-12 19:15:21,694 Stage-1 map = 100%,  reduce = 14%
2016-04-12 19:15:23,709 Stage-1 map = 100%,  reduce = 15%
2016-04-12 19:15:32,763 Stage-1 map = 100%,  reduce = 18%
2016-04-12 19:15:33,771 Stage-1 map = 100%,  reduce = 27%
2016-04-12 19:15:35,785 Stage-1 map = 100%,  reduce = 32%
2016-04-12 19:15:36,794 Stage-1 map = 100%,  reduce = 33%
2016-04-12 19:15:38,808 Stage-1 map = 100%,  reduce = 36%
2016-04-12 19:15:39,817 Stage-1 map = 100%,  reduce = 38%
2016-04-12 19:15:41,834 Stage-1 map = 100%,  reduce = 41%
2016-04-12 19:15:42,844 Stage-1 map = 100%,  reduce = 43%
2016-04-12 19:15:44,859 Stage-1 map = 100%,  reduce = 44%
2016-04-12 19:15:50,898 Stage-1 map = 100%,  reduce = 46%
2016-04-12 19:15:53,918 Stage-1 map = 100%,  reduce = 50%
2016-04-12 19:15:56,938 Stage-1 map = 100%,  reduce = 52%
2016-04-12 19:16:05,991 Stage-1 map = 100%,  reduce = 54%
2016-04-12 19:16:09,011 Stage-1 map = 100%,  reduce = 57%
2016-04-12 19:16:18,063 Stage-1 map = 100%,  reduce = 58%
2016-04-12 19:16:24,099 Stage-1 map = 100%,  reduce = 67%
2016-04-12 19:16:27,119 Stage-1 map = 100%,  reduce = 76%
2016-04-12 19:16:30,139 Stage-1 map = 100%,  reduce = 81%
2016-04-12 19:16:33,160 Stage-1 map = 100%,  reduce = 86%
2016-04-12 19:16:36,180 Stage-1 map = 100%,  reduce = 89%
2016-04-12 19:16:42,215 Stage-1 map = 100%,  reduce = 90%
2016-04-12 19:16:45,234 Stage-1 map = 100%,  reduce = 91%
2016-04-12 19:16:51,269 Stage-1 map = 100%,  reduce = 92%
2016-04-12 19:16:57,303 Stage-1 map = 100%,  reduce = 93%
2016-04-12 19:17:00,322 Stage-1 map = 100%,  reduce = 96%
2016-04-12 19:17:03,341 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121859_0002
Launching Job 2 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121859_0003, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121859_0003
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121859_0003
2016-04-12 19:17:11,941 Stage-2 map = 0%,  reduce = 0%
2016-04-12 19:17:20,979 Stage-2 map = 12%,  reduce = 0%
2016-04-12 19:17:21,986 Stage-2 map = 24%,  reduce = 0%
2016-04-12 19:17:30,022 Stage-2 map = 47%,  reduce = 8%
2016-04-12 19:17:36,049 Stage-2 map = 71%,  reduce = 8%
2016-04-12 19:17:39,064 Stage-2 map = 71%,  reduce = 16%
2016-04-12 19:17:42,079 Stage-2 map = 94%,  reduce = 16%
2016-04-12 19:17:45,093 Stage-2 map = 100%,  reduce = 27%
2016-04-12 19:17:54,132 Stage-2 map = 100%,  reduce = 91%
2016-04-12 19:17:57,146 Stage-2 map = 100%,  reduce = 100%
Ended Job = job_201604121859_0003
Launching Job 3 out of 3
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121859_0004, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121859_0004
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121859_0004
2016-04-12 19:18:06,619 Stage-3 map = 0%,  reduce = 0%
2016-04-12 19:18:09,631 Stage-3 map = 100%,  reduce = 0%
2016-04-12 19:18:18,667 Stage-3 map = 100%,  reduce = 100%
Ended Job = job_201604121859_0004
Loading data to table q17_small_quantity_order_revenue
1 Rows loaded to q17_small_quantity_order_revenue
OK
Time taken: 561.588 seconds
Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121919_1924142954.txt
OK
Time taken: 3.485 seconds
OK
Time taken: 0.064 seconds
FAILED: Error in metadata: MetaException(message:Got exception: org.apache.hadoop.ipc.RemoteException org.apache.hadoop.hdfs.server.namenode.SafeModeException: Cannot delete /user/hive/warehouse/q17_small_quantity_order_revenue. Name node is in safe mode.
The ratio of reported blocks 1.0000 has reached the threshold 0.9990. Safe mode will be turned off automatically in 24 seconds.
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.deleteInternal(FSNamesystem.java:1700)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.delete(FSNamesystem.java:1680)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.delete(NameNode.java:517)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:508)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:959)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:955)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:953)
)
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121919_1931532998.txt
OK
Time taken: 2.856 seconds
OK
Time taken: 0.007 seconds
OK
Time taken: 0.009 seconds
OK
Time taken: 0.599 seconds
OK
Time taken: 0.159 seconds
OK
Time taken: 0.036 seconds
OK
Time taken: 0.061 seconds
OK
Time taken: 0.052 seconds
Total MapReduce jobs = 1
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 8
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121919_0001, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121919_0001
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121919_0001
2016-04-12 19:19:45,836 Stage-1 map = 0%,  reduce = 0%
2016-04-12 19:19:57,923 Stage-1 map = 1%,  reduce = 0%
2016-04-12 19:20:00,956 Stage-1 map = 3%,  reduce = 0%
2016-04-12 19:20:09,041 Stage-1 map = 4%,  reduce = 0%
2016-04-12 19:20:12,073 Stage-1 map = 5%,  reduce = 0%
2016-04-12 19:20:15,106 Stage-1 map = 6%,  reduce = 0%
2016-04-12 19:20:18,138 Stage-1 map = 7%,  reduce = 0%
2016-04-12 19:20:27,222 Stage-1 map = 7%,  reduce = 1%
2016-04-12 19:20:30,253 Stage-1 map = 8%,  reduce = 1%
2016-04-12 19:20:33,282 Stage-1 map = 9%,  reduce = 1%
2016-04-12 19:20:36,313 Stage-1 map = 10%,  reduce = 1%
2016-04-12 19:20:42,366 Stage-1 map = 11%,  reduce = 1%
2016-04-12 19:20:45,394 Stage-1 map = 12%,  reduce = 2%
2016-04-12 19:20:51,448 Stage-1 map = 13%,  reduce = 2%
2016-04-12 19:20:57,500 Stage-1 map = 15%,  reduce = 2%
2016-04-12 19:21:03,550 Stage-1 map = 16%,  reduce = 2%
2016-04-12 19:21:12,623 Stage-1 map = 18%,  reduce = 2%
2016-04-12 19:21:15,651 Stage-1 map = 19%,  reduce = 3%
2016-04-12 19:21:24,723 Stage-1 map = 20%,  reduce = 3%
2016-04-12 19:21:27,749 Stage-1 map = 21%,  reduce = 3%
2016-04-12 19:21:30,777 Stage-1 map = 22%,  reduce = 3%
2016-04-12 19:21:39,849 Stage-1 map = 23%,  reduce = 4%
2016-04-12 19:21:42,876 Stage-1 map = 24%,  reduce = 4%
2016-04-12 19:21:45,899 Stage-1 map = 25%,  reduce = 4%
2016-04-12 19:21:48,921 Stage-1 map = 26%,  reduce = 4%
2016-04-12 19:21:54,961 Stage-1 map = 27%,  reduce = 4%
2016-04-12 19:21:57,983 Stage-1 map = 28%,  reduce = 4%
2016-04-12 19:22:01,004 Stage-1 map = 29%,  reduce = 4%
2016-04-12 19:22:07,045 Stage-1 map = 30%,  reduce = 5%
2016-04-12 19:22:10,065 Stage-1 map = 31%,  reduce = 5%
2016-04-12 19:22:13,085 Stage-1 map = 32%,  reduce = 5%
2016-04-12 19:22:19,123 Stage-1 map = 33%,  reduce = 5%
2016-04-12 19:22:25,161 Stage-1 map = 34%,  reduce = 5%
2016-04-12 19:22:28,180 Stage-1 map = 35%,  reduce = 5%
2016-04-12 19:22:31,199 Stage-1 map = 36%,  reduce = 5%
2016-04-12 19:22:34,218 Stage-1 map = 36%,  reduce = 6%
2016-04-12 19:22:40,253 Stage-1 map = 37%,  reduce = 6%
2016-04-12 19:22:43,275 Stage-1 map = 38%,  reduce = 6%
2016-04-12 19:22:45,289 Stage-1 map = 39%,  reduce = 6%
2016-04-12 19:22:48,308 Stage-1 map = 40%,  reduce = 6%
2016-04-12 19:22:57,360 Stage-1 map = 40%,  reduce = 7%
2016-04-12 19:23:00,380 Stage-1 map = 41%,  reduce = 7%
2016-04-12 19:23:06,415 Stage-1 map = 42%,  reduce = 7%
2016-04-12 19:23:09,434 Stage-1 map = 43%,  reduce = 7%
2016-04-12 19:23:15,471 Stage-1 map = 44%,  reduce = 7%
2016-04-12 19:23:18,491 Stage-1 map = 45%,  reduce = 7%
2016-04-12 19:23:21,511 Stage-1 map = 46%,  reduce = 7%
2016-04-12 19:23:24,530 Stage-1 map = 47%,  reduce = 7%
2016-04-12 19:23:30,567 Stage-1 map = 47%,  reduce = 8%
2016-04-12 19:23:36,605 Stage-1 map = 49%,  reduce = 8%
2016-04-12 19:23:39,624 Stage-1 map = 50%,  reduce = 8%
2016-04-12 19:23:45,659 Stage-1 map = 51%,  reduce = 8%
2016-04-12 19:23:48,678 Stage-1 map = 52%,  reduce = 8%
2016-04-12 19:23:51,703 Stage-1 map = 53%,  reduce = 8%
2016-04-12 19:23:57,740 Stage-1 map = 53%,  reduce = 9%
2016-04-12 19:24:00,759 Stage-1 map = 54%,  reduce = 9%
2016-04-12 19:24:03,779 Stage-1 map = 55%,  reduce = 9%
2016-04-12 19:24:06,798 Stage-1 map = 56%,  reduce = 9%
2016-04-12 19:24:12,834 Stage-1 map = 57%,  reduce = 9%
2016-04-12 19:24:18,870 Stage-1 map = 58%,  reduce = 9%
2016-04-12 19:24:21,889 Stage-1 map = 59%,  reduce = 9%
2016-04-12 19:24:24,908 Stage-1 map = 60%,  reduce = 9%
2016-04-12 19:24:27,927 Stage-1 map = 60%,  reduce = 10%
2016-04-12 19:24:30,948 Stage-1 map = 61%,  reduce = 10%
2016-04-12 19:24:36,985 Stage-1 map = 63%,  reduce = 10%
2016-04-12 19:24:43,023 Stage-1 map = 64%,  reduce = 10%
2016-04-12 19:24:49,059 Stage-1 map = 65%,  reduce = 11%
2016-04-12 19:24:52,078 Stage-1 map = 66%,  reduce = 11%
2016-04-12 19:24:55,098 Stage-1 map = 67%,  reduce = 11%
2016-04-12 19:25:01,134 Stage-1 map = 68%,  reduce = 11%
2016-04-12 19:25:07,170 Stage-1 map = 69%,  reduce = 11%
2016-04-12 19:25:10,189 Stage-1 map = 70%,  reduce = 11%
2016-04-12 19:25:13,208 Stage-1 map = 71%,  reduce = 11%
2016-04-12 19:25:19,244 Stage-1 map = 72%,  reduce = 12%
2016-04-12 19:25:22,264 Stage-1 map = 73%,  reduce = 12%
2016-04-12 19:25:25,284 Stage-1 map = 74%,  reduce = 12%
2016-04-12 19:25:34,336 Stage-1 map = 75%,  reduce = 12%
2016-04-12 19:25:37,355 Stage-1 map = 77%,  reduce = 12%
2016-04-12 19:25:43,389 Stage-1 map = 78%,  reduce = 12%
2016-04-12 19:25:49,425 Stage-1 map = 78%,  reduce = 13%
2016-04-12 19:25:52,444 Stage-1 map = 79%,  reduce = 13%
2016-04-12 19:25:55,462 Stage-1 map = 80%,  reduce = 13%
2016-04-12 19:26:01,499 Stage-1 map = 81%,  reduce = 13%
2016-04-12 19:26:04,518 Stage-1 map = 82%,  reduce = 13%
2016-04-12 19:26:09,552 Stage-1 map = 83%,  reduce = 13%
2016-04-12 19:26:12,571 Stage-1 map = 84%,  reduce = 14%
2016-04-12 19:26:18,606 Stage-1 map = 85%,  reduce = 14%
2016-04-12 19:26:21,624 Stage-1 map = 86%,  reduce = 14%
2016-04-12 19:26:24,644 Stage-1 map = 87%,  reduce = 14%
2016-04-12 19:26:27,664 Stage-1 map = 88%,  reduce = 14%
2016-04-12 19:26:33,701 Stage-1 map = 89%,  reduce = 14%
2016-04-12 19:26:36,721 Stage-1 map = 89%,  reduce = 15%
2016-04-12 19:26:39,741 Stage-1 map = 90%,  reduce = 15%
2016-04-12 19:26:42,760 Stage-1 map = 91%,  reduce = 15%
2016-04-12 19:26:51,814 Stage-1 map = 92%,  reduce = 15%
2016-04-12 19:26:54,834 Stage-1 map = 94%,  reduce = 15%
2016-04-12 19:27:00,870 Stage-1 map = 95%,  reduce = 15%
2016-04-12 19:27:03,890 Stage-1 map = 95%,  reduce = 16%
2016-04-12 19:27:06,910 Stage-1 map = 96%,  reduce = 16%
2016-04-12 19:27:09,930 Stage-1 map = 97%,  reduce = 16%
2016-04-12 19:27:12,950 Stage-1 map = 98%,  reduce = 16%
2016-04-12 19:27:22,004 Stage-1 map = 99%,  reduce = 16%
2016-04-12 19:27:25,024 Stage-1 map = 100%,  reduce = 16%
2016-04-12 19:27:31,063 Stage-1 map = 100%,  reduce = 21%
2016-04-12 19:27:34,083 Stage-1 map = 100%,  reduce = 34%
2016-04-12 19:27:37,103 Stage-1 map = 100%,  reduce = 37%
2016-04-12 19:27:40,122 Stage-1 map = 100%,  reduce = 43%
2016-04-12 19:27:43,152 Stage-1 map = 100%,  reduce = 49%
2016-04-12 19:27:46,174 Stage-1 map = 100%,  reduce = 50%
2016-04-12 19:27:52,213 Stage-1 map = 100%,  reduce = 52%
2016-04-12 19:27:55,234 Stage-1 map = 100%,  reduce = 56%
2016-04-12 19:27:58,256 Stage-1 map = 100%,  reduce = 59%
2016-04-12 19:28:10,327 Stage-1 map = 100%,  reduce = 62%
2016-04-12 19:28:13,348 Stage-1 map = 100%,  reduce = 66%
2016-04-12 19:28:28,437 Stage-1 map = 100%,  reduce = 67%
2016-04-12 19:28:31,457 Stage-1 map = 100%,  reduce = 80%
2016-04-12 19:28:34,477 Stage-1 map = 100%,  reduce = 87%
2016-04-12 19:28:37,498 Stage-1 map = 100%,  reduce = 93%
2016-04-12 19:28:40,518 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121919_0001
Loading data to table lineitem_tmp
2000000 Rows loaded to lineitem_tmp
OK
Time taken: 544.476 seconds
Total MapReduce jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 9
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121919_0002, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121919_0002
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121919_0002
2016-04-12 19:28:48,917 Stage-1 map = 0%,  reduce = 0%
2016-04-12 19:28:57,977 Stage-1 map = 3%,  reduce = 0%
2016-04-12 19:29:07,025 Stage-1 map = 5%,  reduce = 0%
2016-04-12 19:29:10,043 Stage-1 map = 7%,  reduce = 0%
2016-04-12 19:29:19,093 Stage-1 map = 8%,  reduce = 0%
2016-04-12 19:29:22,112 Stage-1 map = 9%,  reduce = 1%
2016-04-12 19:29:25,131 Stage-1 map = 10%,  reduce = 1%
2016-04-12 19:29:34,181 Stage-1 map = 12%,  reduce = 1%
2016-04-12 19:29:37,199 Stage-1 map = 13%,  reduce = 1%
2016-04-12 19:29:46,249 Stage-1 map = 14%,  reduce = 2%
2016-04-12 19:29:49,268 Stage-1 map = 16%,  reduce = 2%
2016-04-12 19:29:52,286 Stage-1 map = 17%,  reduce = 2%
2016-04-12 19:29:58,318 Stage-1 map = 18%,  reduce = 2%
2016-04-12 19:30:04,352 Stage-1 map = 19%,  reduce = 3%
2016-04-12 19:30:07,372 Stage-1 map = 20%,  reduce = 3%
2016-04-12 19:30:10,389 Stage-1 map = 21%,  reduce = 3%
2016-04-12 19:30:13,407 Stage-1 map = 22%,  reduce = 3%
2016-04-12 19:30:16,424 Stage-1 map = 23%,  reduce = 3%
2016-04-12 19:30:22,456 Stage-1 map = 24%,  reduce = 3%
2016-04-12 19:30:25,474 Stage-1 map = 25%,  reduce = 3%
2016-04-12 19:30:28,492 Stage-1 map = 26%,  reduce = 3%
2016-04-12 19:30:31,509 Stage-1 map = 27%,  reduce = 4%
2016-04-12 19:30:34,527 Stage-1 map = 28%,  reduce = 4%
2016-04-12 19:30:40,559 Stage-1 map = 29%,  reduce = 4%
2016-04-12 19:30:43,577 Stage-1 map = 30%,  reduce = 4%
2016-04-12 19:30:46,595 Stage-1 map = 31%,  reduce = 4%
2016-04-12 19:30:49,613 Stage-1 map = 32%,  reduce = 4%
2016-04-12 19:30:52,631 Stage-1 map = 33%,  reduce = 4%
2016-04-12 19:30:55,648 Stage-1 map = 34%,  reduce = 5%
2016-04-12 19:31:01,681 Stage-1 map = 35%,  reduce = 5%
2016-04-12 19:31:04,700 Stage-1 map = 36%,  reduce = 5%
2016-04-12 19:31:07,718 Stage-1 map = 37%,  reduce = 5%
2016-04-12 19:31:13,753 Stage-1 map = 39%,  reduce = 5%
2016-04-12 19:31:19,786 Stage-1 map = 40%,  reduce = 5%
2016-04-12 19:31:22,804 Stage-1 map = 40%,  reduce = 6%
2016-04-12 19:31:28,838 Stage-1 map = 41%,  reduce = 6%
2016-04-12 19:31:31,857 Stage-1 map = 42%,  reduce = 6%
2016-04-12 19:31:34,877 Stage-1 map = 43%,  reduce = 6%
2016-04-12 19:31:40,911 Stage-1 map = 45%,  reduce = 6%
2016-04-12 19:31:43,930 Stage-1 map = 46%,  reduce = 6%
2016-04-12 19:31:46,948 Stage-1 map = 47%,  reduce = 6%
2016-04-12 19:31:52,982 Stage-1 map = 49%,  reduce = 7%
2016-04-12 19:31:59,017 Stage-1 map = 50%,  reduce = 7%
2016-04-12 19:32:05,052 Stage-1 map = 52%,  reduce = 7%
2016-04-12 19:32:11,085 Stage-1 map = 53%,  reduce = 7%
2016-04-12 19:32:16,115 Stage-1 map = 55%,  reduce = 8%
2016-04-12 19:32:19,134 Stage-1 map = 56%,  reduce = 8%
2016-04-12 19:32:25,170 Stage-1 map = 57%,  reduce = 8%
2016-04-12 19:32:28,189 Stage-1 map = 59%,  reduce = 8%
2016-04-12 19:32:34,224 Stage-1 map = 60%,  reduce = 8%
2016-04-12 19:32:37,245 Stage-1 map = 61%,  reduce = 9%
2016-04-12 19:32:43,279 Stage-1 map = 62%,  reduce = 9%
2016-04-12 19:32:46,298 Stage-1 map = 63%,  reduce = 9%
2016-04-12 19:32:49,318 Stage-1 map = 64%,  reduce = 9%
2016-04-12 19:32:55,352 Stage-1 map = 65%,  reduce = 9%
2016-04-12 19:32:58,371 Stage-1 map = 67%,  reduce = 9%
2016-04-12 19:33:01,390 Stage-1 map = 67%,  reduce = 10%
2016-04-12 19:33:07,425 Stage-1 map = 69%,  reduce = 10%
2016-04-12 19:33:10,444 Stage-1 map = 70%,  reduce = 10%
2016-04-12 19:33:13,463 Stage-1 map = 71%,  reduce = 10%
2016-04-12 19:33:19,497 Stage-1 map = 72%,  reduce = 10%
2016-04-12 19:33:22,516 Stage-1 map = 73%,  reduce = 10%
2016-04-12 19:33:28,553 Stage-1 map = 74%,  reduce = 10%
2016-04-12 19:33:31,572 Stage-1 map = 74%,  reduce = 11%
2016-04-12 19:33:34,591 Stage-1 map = 76%,  reduce = 11%
2016-04-12 19:33:37,611 Stage-1 map = 77%,  reduce = 11%
2016-04-12 19:33:46,663 Stage-1 map = 79%,  reduce = 11%
2016-04-12 19:33:49,682 Stage-1 map = 81%,  reduce = 11%
2016-04-12 19:33:55,715 Stage-1 map = 81%,  reduce = 12%
2016-04-12 19:33:58,733 Stage-1 map = 83%,  reduce = 12%
2016-04-12 19:34:01,751 Stage-1 map = 84%,  reduce = 12%
2016-04-12 19:34:10,799 Stage-1 map = 86%,  reduce = 12%
2016-04-12 19:34:13,817 Stage-1 map = 87%,  reduce = 12%
2016-04-12 19:34:19,852 Stage-1 map = 88%,  reduce = 13%
2016-04-12 19:34:22,870 Stage-1 map = 89%,  reduce = 13%
2016-04-12 19:34:25,888 Stage-1 map = 91%,  reduce = 13%
2016-04-12 19:34:31,923 Stage-1 map = 92%,  reduce = 13%
2016-04-12 19:34:37,957 Stage-1 map = 94%,  reduce = 14%
2016-04-12 19:34:43,991 Stage-1 map = 96%,  reduce = 14%
2016-04-12 19:34:47,010 Stage-1 map = 97%,  reduce = 14%
2016-04-12 19:34:53,045 Stage-1 map = 98%,  reduce = 14%
2016-04-12 19:34:56,065 Stage-1 map = 100%,  reduce = 14%
2016-04-12 19:35:05,120 Stage-1 map = 100%,  reduce = 18%
2016-04-12 19:35:08,139 Stage-1 map = 100%,  reduce = 31%
2016-04-12 19:35:11,157 Stage-1 map = 100%,  reduce = 34%
2016-04-12 19:35:14,175 Stage-1 map = 100%,  reduce = 39%
2016-04-12 19:35:17,197 Stage-1 map = 100%,  reduce = 44%
2016-04-12 19:35:26,247 Stage-1 map = 100%,  reduce = 46%
2016-04-12 19:35:29,266 Stage-1 map = 100%,  reduce = 50%
2016-04-12 19:35:32,285 Stage-1 map = 100%,  reduce = 52%
2016-04-12 19:35:41,335 Stage-1 map = 100%,  reduce = 54%
2016-04-12 19:35:44,354 Stage-1 map = 100%,  reduce = 57%
2016-04-12 19:35:55,413 Stage-1 map = 100%,  reduce = 59%
2016-04-12 19:35:58,432 Stage-1 map = 100%,  reduce = 70%
2016-04-12 19:36:01,451 Stage-1 map = 100%,  reduce = 76%
2016-04-12 19:36:04,470 Stage-1 map = 100%,  reduce = 80%
2016-04-12 19:36:07,489 Stage-1 map = 100%,  reduce = 86%
2016-04-12 19:36:10,510 Stage-1 map = 100%,  reduce = 89%
2016-04-12 19:36:16,544 Stage-1 map = 100%,  reduce = 90%
2016-04-12 19:36:19,563 Stage-1 map = 100%,  reduce = 91%
2016-04-12 19:36:25,597 Stage-1 map = 100%,  reduce = 92%
2016-04-12 19:36:31,631 Stage-1 map = 100%,  reduce = 93%
2016-04-12 19:36:34,650 Stage-1 map = 100%,  reduce = 97%
2016-04-12 19:36:37,668 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121919_0002
Launching Job 2 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121919_0003, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121919_0003
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121919_0003
2016-04-12 19:36:47,272 Stage-2 map = 0%,  reduce = 0%
2016-04-12 19:36:56,305 Stage-2 map = 24%,  reduce = 0%
2016-04-12 19:37:05,341 Stage-2 map = 47%,  reduce = 8%
2016-04-12 19:37:11,366 Stage-2 map = 71%,  reduce = 8%
2016-04-12 19:37:14,380 Stage-2 map = 71%,  reduce = 16%
2016-04-12 19:37:17,393 Stage-2 map = 94%,  reduce = 16%
2016-04-12 19:37:20,407 Stage-2 map = 100%,  reduce = 31%
2016-04-12 19:37:29,444 Stage-2 map = 100%,  reduce = 87%
2016-04-12 19:37:32,458 Stage-2 map = 100%,  reduce = 100%
Ended Job = job_201604121919_0003
Launching Job 3 out of 3
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121919_0004, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121919_0004
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121919_0004
2016-04-12 19:37:40,952 Stage-3 map = 0%,  reduce = 0%
2016-04-12 19:37:43,965 Stage-3 map = 100%,  reduce = 0%
2016-04-12 19:37:52,999 Stage-3 map = 100%,  reduce = 100%
Ended Job = job_201604121919_0004
Loading data to table q17_small_quantity_order_revenue
1 Rows loaded to q17_small_quantity_order_revenue
OK
Time taken: 552.354 seconds
Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121939_1819982675.txt
OK
Time taken: 3.547 seconds
OK
Time taken: 0.064 seconds
FAILED: Error in metadata: MetaException(message:Got exception: org.apache.hadoop.ipc.RemoteException org.apache.hadoop.hdfs.server.namenode.SafeModeException: Cannot delete /user/hive/warehouse/q17_small_quantity_order_revenue. Name node is in safe mode.
The ratio of reported blocks 1.0000 has reached the threshold 0.9990. Safe mode will be turned off automatically in 24 seconds.
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.deleteInternal(FSNamesystem.java:1700)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.delete(FSNamesystem.java:1680)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.delete(NameNode.java:517)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:508)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:959)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:955)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:953)
)
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
Hive history file=/tmp/hadoop/hive_job_log_hadoop_201604121939_1819797770.txt
OK
Time taken: 2.97 seconds
OK
Time taken: 0.009 seconds
OK
Time taken: 0.012 seconds
OK
Time taken: 0.607 seconds
OK
Time taken: 0.155 seconds
OK
Time taken: 0.042 seconds
OK
Time taken: 0.032 seconds
OK
Time taken: 0.052 seconds
Total MapReduce jobs = 1
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 8
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121939_0001, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121939_0001
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121939_0001
2016-04-12 19:39:17,558 Stage-1 map = 0%,  reduce = 0%
2016-04-12 19:39:26,625 Stage-1 map = 1%,  reduce = 0%
2016-04-12 19:39:29,648 Stage-1 map = 2%,  reduce = 0%
2016-04-12 19:39:32,683 Stage-1 map = 3%,  reduce = 0%
2016-04-12 19:39:41,769 Stage-1 map = 4%,  reduce = 0%
2016-04-12 19:39:44,799 Stage-1 map = 5%,  reduce = 0%
2016-04-12 19:39:47,830 Stage-1 map = 7%,  reduce = 0%
2016-04-12 19:39:56,915 Stage-1 map = 7%,  reduce = 1%
2016-04-12 19:40:02,969 Stage-1 map = 8%,  reduce = 1%
2016-04-12 19:40:05,996 Stage-1 map = 10%,  reduce = 1%
2016-04-12 19:40:15,071 Stage-1 map = 11%,  reduce = 1%
2016-04-12 19:40:18,099 Stage-1 map = 11%,  reduce = 2%
2016-04-12 19:40:21,127 Stage-1 map = 13%,  reduce = 2%
2016-04-12 19:40:27,177 Stage-1 map = 14%,  reduce = 2%
2016-04-12 19:40:30,204 Stage-1 map = 15%,  reduce = 2%
2016-04-12 19:40:36,254 Stage-1 map = 16%,  reduce = 2%
2016-04-12 19:40:42,302 Stage-1 map = 17%,  reduce = 2%
2016-04-12 19:40:45,328 Stage-1 map = 18%,  reduce = 2%
2016-04-12 19:40:48,354 Stage-1 map = 18%,  reduce = 3%
2016-04-12 19:40:51,380 Stage-1 map = 19%,  reduce = 3%
2016-04-12 19:40:54,406 Stage-1 map = 20%,  reduce = 3%
2016-04-12 19:41:00,453 Stage-1 map = 21%,  reduce = 3%
2016-04-12 19:41:03,479 Stage-1 map = 22%,  reduce = 3%
2016-04-12 19:41:09,526 Stage-1 map = 23%,  reduce = 3%
2016-04-12 19:41:12,557 Stage-1 map = 24%,  reduce = 4%
2016-04-12 19:41:15,583 Stage-1 map = 25%,  reduce = 4%
2016-04-12 19:41:21,623 Stage-1 map = 26%,  reduce = 4%
2016-04-12 19:41:24,644 Stage-1 map = 27%,  reduce = 4%
2016-04-12 19:41:30,683 Stage-1 map = 28%,  reduce = 4%
2016-04-12 19:41:32,698 Stage-1 map = 29%,  reduce = 4%
2016-04-12 19:41:36,725 Stage-1 map = 29%,  reduce = 5%
2016-04-12 19:41:39,746 Stage-1 map = 30%,  reduce = 5%
2016-04-12 19:41:44,780 Stage-1 map = 31%,  reduce = 5%
2016-04-12 19:41:45,790 Stage-1 map = 32%,  reduce = 5%
2016-04-12 19:41:50,821 Stage-1 map = 33%,  reduce = 5%
2016-04-12 19:41:56,858 Stage-1 map = 34%,  reduce = 5%
2016-04-12 19:42:02,894 Stage-1 map = 35%,  reduce = 5%
2016-04-12 19:42:05,913 Stage-1 map = 36%,  reduce = 6%
2016-04-12 19:42:08,933 Stage-1 map = 37%,  reduce = 6%
2016-04-12 19:42:14,970 Stage-1 map = 38%,  reduce = 6%
2016-04-12 19:42:17,989 Stage-1 map = 39%,  reduce = 6%
2016-04-12 19:42:21,009 Stage-1 map = 40%,  reduce = 6%
2016-04-12 19:42:27,045 Stage-1 map = 40%,  reduce = 7%
2016-04-12 19:42:30,065 Stage-1 map = 41%,  reduce = 7%
2016-04-12 19:42:33,084 Stage-1 map = 42%,  reduce = 7%
2016-04-12 19:42:39,121 Stage-1 map = 43%,  reduce = 7%
2016-04-12 19:42:48,174 Stage-1 map = 44%,  reduce = 7%
2016-04-12 19:42:51,206 Stage-1 map = 45%,  reduce = 7%
2016-04-12 19:42:54,226 Stage-1 map = 46%,  reduce = 7%
2016-04-12 19:42:57,246 Stage-1 map = 47%,  reduce = 7%
2016-04-12 19:43:03,282 Stage-1 map = 48%,  reduce = 8%
2016-04-12 19:43:06,301 Stage-1 map = 49%,  reduce = 8%
2016-04-12 19:43:12,337 Stage-1 map = 50%,  reduce = 8%
2016-04-12 19:43:18,374 Stage-1 map = 51%,  reduce = 8%
2016-04-12 19:43:21,394 Stage-1 map = 52%,  reduce = 8%
2016-04-12 19:43:24,413 Stage-1 map = 53%,  reduce = 8%
2016-04-12 19:43:30,454 Stage-1 map = 54%,  reduce = 9%
2016-04-12 19:43:33,473 Stage-1 map = 55%,  reduce = 9%
2016-04-12 19:43:36,493 Stage-1 map = 56%,  reduce = 9%
2016-04-12 19:43:42,530 Stage-1 map = 57%,  reduce = 9%
2016-04-12 19:43:48,567 Stage-1 map = 58%,  reduce = 9%
2016-04-12 19:43:51,587 Stage-1 map = 59%,  reduce = 9%
2016-04-12 19:43:54,607 Stage-1 map = 60%,  reduce = 9%
2016-04-12 19:44:00,644 Stage-1 map = 61%,  reduce = 10%
2016-04-12 19:44:06,681 Stage-1 map = 63%,  reduce = 10%
2016-04-12 19:44:09,700 Stage-1 map = 64%,  reduce = 10%
2016-04-12 19:44:18,752 Stage-1 map = 65%,  reduce = 11%
2016-04-12 19:44:21,771 Stage-1 map = 66%,  reduce = 11%
2016-04-12 19:44:24,791 Stage-1 map = 67%,  reduce = 11%
2016-04-12 19:44:33,844 Stage-1 map = 68%,  reduce = 11%
2016-04-12 19:44:36,864 Stage-1 map = 69%,  reduce = 11%
2016-04-12 19:44:39,884 Stage-1 map = 70%,  reduce = 11%
2016-04-12 19:44:42,903 Stage-1 map = 71%,  reduce = 11%
2016-04-12 19:44:48,939 Stage-1 map = 72%,  reduce = 12%
2016-04-12 19:44:53,970 Stage-1 map = 73%,  reduce = 12%
2016-04-12 19:44:56,989 Stage-1 map = 74%,  reduce = 12%
2016-04-12 19:45:04,031 Stage-1 map = 75%,  reduce = 12%
2016-04-12 19:45:07,051 Stage-1 map = 76%,  reduce = 12%
2016-04-12 19:45:09,065 Stage-1 map = 77%,  reduce = 12%
2016-04-12 19:45:12,084 Stage-1 map = 78%,  reduce = 12%
2016-04-12 19:45:15,104 Stage-1 map = 78%,  reduce = 13%
2016-04-12 19:45:21,142 Stage-1 map = 79%,  reduce = 13%
2016-04-12 19:45:24,161 Stage-1 map = 80%,  reduce = 13%
2016-04-12 19:45:30,198 Stage-1 map = 81%,  reduce = 13%
2016-04-12 19:45:33,217 Stage-1 map = 82%,  reduce = 13%
2016-04-12 19:45:39,253 Stage-1 map = 83%,  reduce = 14%
2016-04-12 19:45:42,273 Stage-1 map = 84%,  reduce = 14%
2016-04-12 19:45:51,326 Stage-1 map = 85%,  reduce = 14%
2016-04-12 19:45:54,345 Stage-1 map = 87%,  reduce = 14%
2016-04-12 19:45:57,364 Stage-1 map = 88%,  reduce = 14%
2016-04-12 19:46:06,415 Stage-1 map = 89%,  reduce = 14%
2016-04-12 19:46:09,435 Stage-1 map = 90%,  reduce = 15%
2016-04-12 19:46:12,454 Stage-1 map = 91%,  reduce = 15%
2016-04-12 19:46:18,490 Stage-1 map = 92%,  reduce = 15%
2016-04-12 19:46:21,508 Stage-1 map = 93%,  reduce = 15%
2016-04-12 19:46:24,527 Stage-1 map = 94%,  reduce = 15%
2016-04-12 19:46:30,564 Stage-1 map = 95%,  reduce = 15%
2016-04-12 19:46:36,599 Stage-1 map = 96%,  reduce = 16%
2016-04-12 19:46:39,618 Stage-1 map = 97%,  reduce = 16%
2016-04-12 19:46:42,637 Stage-1 map = 98%,  reduce = 16%
2016-04-12 19:46:48,673 Stage-1 map = 99%,  reduce = 16%
2016-04-12 19:46:54,710 Stage-1 map = 100%,  reduce = 16%
2016-04-12 19:47:00,747 Stage-1 map = 100%,  reduce = 21%
2016-04-12 19:47:03,767 Stage-1 map = 100%,  reduce = 26%
2016-04-12 19:47:06,786 Stage-1 map = 100%,  reduce = 36%
2016-04-12 19:47:09,807 Stage-1 map = 100%,  reduce = 41%
2016-04-12 19:47:12,829 Stage-1 map = 100%,  reduce = 46%
2016-04-12 19:47:15,850 Stage-1 map = 100%,  reduce = 50%
2016-04-12 19:47:21,889 Stage-1 map = 100%,  reduce = 51%
2016-04-12 19:47:24,910 Stage-1 map = 100%,  reduce = 54%
2016-04-12 19:47:27,931 Stage-1 map = 100%,  reduce = 58%
2016-04-12 19:47:30,953 Stage-1 map = 100%,  reduce = 59%
2016-04-12 19:47:37,004 Stage-1 map = 100%,  reduce = 60%
2016-04-12 19:47:40,024 Stage-1 map = 100%,  reduce = 61%
2016-04-12 19:47:43,045 Stage-1 map = 100%,  reduce = 64%
2016-04-12 19:47:46,065 Stage-1 map = 100%,  reduce = 66%
2016-04-12 19:47:58,139 Stage-1 map = 100%,  reduce = 70%
2016-04-12 19:48:01,159 Stage-1 map = 100%,  reduce = 76%
2016-04-12 19:48:04,179 Stage-1 map = 100%,  reduce = 87%
2016-04-12 19:48:07,199 Stage-1 map = 100%,  reduce = 92%
2016-04-12 19:48:10,219 Stage-1 map = 100%,  reduce = 97%
2016-04-12 19:48:13,239 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121939_0001
Loading data to table lineitem_tmp
2000000 Rows loaded to lineitem_tmp
OK
Time taken: 544.524 seconds
Total MapReduce jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 9
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121939_0002, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121939_0002
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121939_0002
2016-04-12 19:48:21,705 Stage-1 map = 0%,  reduce = 0%
2016-04-12 19:48:30,750 Stage-1 map = 3%,  reduce = 0%
2016-04-12 19:48:39,803 Stage-1 map = 5%,  reduce = 0%
2016-04-12 19:48:42,839 Stage-1 map = 6%,  reduce = 0%
2016-04-12 19:48:45,857 Stage-1 map = 7%,  reduce = 0%
2016-04-12 19:48:54,909 Stage-1 map = 9%,  reduce = 1%
2016-04-12 19:48:57,929 Stage-1 map = 10%,  reduce = 1%
2016-04-12 19:49:06,979 Stage-1 map = 12%,  reduce = 1%
2016-04-12 19:49:09,998 Stage-1 map = 13%,  reduce = 1%
2016-04-12 19:49:16,032 Stage-1 map = 13%,  reduce = 2%
2016-04-12 19:49:19,051 Stage-1 map = 14%,  reduce = 2%
2016-04-12 19:49:22,069 Stage-1 map = 16%,  reduce = 2%
2016-04-12 19:49:25,088 Stage-1 map = 17%,  reduce = 2%
2016-04-12 19:49:31,122 Stage-1 map = 18%,  reduce = 2%
2016-04-12 19:49:37,157 Stage-1 map = 19%,  reduce = 3%
2016-04-12 19:49:40,177 Stage-1 map = 20%,  reduce = 3%
2016-04-12 19:49:43,196 Stage-1 map = 21%,  reduce = 3%
2016-04-12 19:49:46,215 Stage-1 map = 22%,  reduce = 3%
2016-04-12 19:49:49,232 Stage-1 map = 23%,  reduce = 3%
2016-04-12 19:49:55,265 Stage-1 map = 24%,  reduce = 3%
2016-04-12 19:49:58,284 Stage-1 map = 25%,  reduce = 3%
2016-04-12 19:50:01,303 Stage-1 map = 26%,  reduce = 3%
2016-04-12 19:50:04,321 Stage-1 map = 27%,  reduce = 3%
2016-04-12 19:50:07,339 Stage-1 map = 28%,  reduce = 4%
2016-04-12 19:50:13,373 Stage-1 map = 29%,  reduce = 4%
2016-04-12 19:50:16,391 Stage-1 map = 30%,  reduce = 4%
2016-04-12 19:50:19,409 Stage-1 map = 31%,  reduce = 4%
2016-04-12 19:50:22,426 Stage-1 map = 32%,  reduce = 4%
2016-04-12 19:50:25,444 Stage-1 map = 33%,  reduce = 4%
2016-04-12 19:50:28,462 Stage-1 map = 33%,  reduce = 5%
2016-04-12 19:50:30,475 Stage-1 map = 34%,  reduce = 5%
2016-04-12 19:50:33,493 Stage-1 map = 35%,  reduce = 5%
2016-04-12 19:50:37,516 Stage-1 map = 36%,  reduce = 5%
2016-04-12 19:50:40,535 Stage-1 map = 37%,  reduce = 5%
2016-04-12 19:50:42,550 Stage-1 map = 38%,  reduce = 5%
2016-04-12 19:50:49,589 Stage-1 map = 39%,  reduce = 5%
2016-04-12 19:50:52,608 Stage-1 map = 39%,  reduce = 6%
2016-04-12 19:50:54,621 Stage-1 map = 40%,  reduce = 6%
2016-04-12 19:50:57,640 Stage-1 map = 41%,  reduce = 6%
2016-04-12 19:51:00,658 Stage-1 map = 42%,  reduce = 6%
2016-04-12 19:51:06,692 Stage-1 map = 43%,  reduce = 6%
2016-04-12 19:51:09,710 Stage-1 map = 44%,  reduce = 6%
2016-04-12 19:51:12,729 Stage-1 map = 45%,  reduce = 6%
2016-04-12 19:51:21,778 Stage-1 map = 47%,  reduce = 7%
2016-04-12 19:51:24,797 Stage-1 map = 48%,  reduce = 7%
2016-04-12 19:51:33,847 Stage-1 map = 49%,  reduce = 7%
2016-04-12 19:51:36,865 Stage-1 map = 51%,  reduce = 7%
2016-04-12 19:51:39,884 Stage-1 map = 52%,  reduce = 7%
2016-04-12 19:51:48,935 Stage-1 map = 53%,  reduce = 7%
2016-04-12 19:51:51,953 Stage-1 map = 54%,  reduce = 8%
2016-04-12 19:51:54,971 Stage-1 map = 55%,  reduce = 8%
2016-04-12 19:52:01,004 Stage-1 map = 56%,  reduce = 8%
2016-04-12 19:52:04,023 Stage-1 map = 58%,  reduce = 8%
2016-04-12 19:52:16,091 Stage-1 map = 60%,  reduce = 8%
2016-04-12 19:52:19,110 Stage-1 map = 62%,  reduce = 9%
2016-04-12 19:52:28,163 Stage-1 map = 64%,  reduce = 9%
2016-04-12 19:52:31,181 Stage-1 map = 65%,  reduce = 9%
2016-04-12 19:52:40,229 Stage-1 map = 67%,  reduce = 9%
2016-04-12 19:52:43,248 Stage-1 map = 68%,  reduce = 10%
2016-04-12 19:52:52,296 Stage-1 map = 70%,  reduce = 10%
2016-04-12 19:52:55,314 Stage-1 map = 72%,  reduce = 10%
2016-04-12 19:53:04,364 Stage-1 map = 73%,  reduce = 11%
2016-04-12 19:53:07,382 Stage-1 map = 74%,  reduce = 11%
2016-04-12 19:53:10,401 Stage-1 map = 75%,  reduce = 11%
2016-04-12 19:53:19,449 Stage-1 map = 77%,  reduce = 11%
2016-04-12 19:53:22,467 Stage-1 map = 78%,  reduce = 11%
2016-04-12 19:53:31,514 Stage-1 map = 80%,  reduce = 12%
2016-04-12 19:53:34,533 Stage-1 map = 82%,  reduce = 12%
2016-04-12 19:53:43,583 Stage-1 map = 84%,  reduce = 12%
2016-04-12 19:53:46,600 Stage-1 map = 85%,  reduce = 12%
2016-04-12 19:53:52,634 Stage-1 map = 86%,  reduce = 12%
2016-04-12 19:53:58,668 Stage-1 map = 88%,  reduce = 13%
2016-04-12 19:54:04,701 Stage-1 map = 89%,  reduce = 13%
2016-04-12 19:54:09,729 Stage-1 map = 90%,  reduce = 13%
2016-04-12 19:54:10,737 Stage-1 map = 91%,  reduce = 13%
2016-04-12 19:54:12,750 Stage-1 map = 92%,  reduce = 13%
2016-04-12 19:54:19,794 Stage-1 map = 93%,  reduce = 13%
2016-04-12 19:54:21,808 Stage-1 map = 94%,  reduce = 14%
2016-04-12 19:54:24,826 Stage-1 map = 95%,  reduce = 14%
2016-04-12 19:54:31,864 Stage-1 map = 96%,  reduce = 14%
2016-04-12 19:54:33,878 Stage-1 map = 98%,  reduce = 14%
2016-04-12 19:54:42,927 Stage-1 map = 100%,  reduce = 14%
2016-04-12 19:54:45,945 Stage-1 map = 100%,  reduce = 15%
2016-04-12 19:54:54,994 Stage-1 map = 100%,  reduce = 30%
2016-04-12 19:54:58,013 Stage-1 map = 100%,  reduce = 33%
2016-04-12 19:55:01,031 Stage-1 map = 100%,  reduce = 37%
2016-04-12 19:55:04,053 Stage-1 map = 100%,  reduce = 43%
2016-04-12 19:55:07,072 Stage-1 map = 100%,  reduce = 44%
2016-04-12 19:55:13,109 Stage-1 map = 100%,  reduce = 46%
2016-04-12 19:55:16,129 Stage-1 map = 100%,  reduce = 48%
2016-04-12 19:55:19,149 Stage-1 map = 100%,  reduce = 51%
2016-04-12 19:55:22,168 Stage-1 map = 100%,  reduce = 52%
2016-04-12 19:55:28,203 Stage-1 map = 100%,  reduce = 54%
2016-04-12 19:55:31,222 Stage-1 map = 100%,  reduce = 56%
2016-04-12 19:55:34,241 Stage-1 map = 100%,  reduce = 57%
2016-04-12 19:55:43,292 Stage-1 map = 100%,  reduce = 58%
2016-04-12 19:55:46,311 Stage-1 map = 100%,  reduce = 63%
2016-04-12 19:55:49,329 Stage-1 map = 100%,  reduce = 72%
2016-04-12 19:55:52,348 Stage-1 map = 100%,  reduce = 80%
2016-04-12 19:55:55,366 Stage-1 map = 100%,  reduce = 85%
2016-04-12 19:55:58,385 Stage-1 map = 100%,  reduce = 89%
2016-04-12 19:56:04,419 Stage-1 map = 100%,  reduce = 90%
2016-04-12 19:56:07,438 Stage-1 map = 100%,  reduce = 91%
2016-04-12 19:56:13,474 Stage-1 map = 100%,  reduce = 92%
2016-04-12 19:56:22,524 Stage-1 map = 100%,  reduce = 96%
2016-04-12 19:56:25,543 Stage-1 map = 100%,  reduce = 98%
2016-04-12 19:56:28,563 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_201604121939_0002
Launching Job 2 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121939_0003, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121939_0003
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121939_0003
2016-04-12 19:56:37,198 Stage-2 map = 0%,  reduce = 0%
2016-04-12 19:56:46,233 Stage-2 map = 24%,  reduce = 0%
2016-04-12 19:56:55,270 Stage-2 map = 47%,  reduce = 8%
2016-04-12 19:57:01,296 Stage-2 map = 71%,  reduce = 8%
2016-04-12 19:57:04,310 Stage-2 map = 71%,  reduce = 16%
2016-04-12 19:57:07,324 Stage-2 map = 94%,  reduce = 16%
2016-04-12 19:57:10,338 Stage-2 map = 100%,  reduce = 31%
2016-04-12 19:57:19,376 Stage-2 map = 100%,  reduce = 94%
2016-04-12 19:57:22,390 Stage-2 map = 100%,  reduce = 100%
Ended Job = job_201604121939_0003
Launching Job 3 out of 3
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201604121939_0004, Tracking URL = http://belona.c3local:50030/jobdetails.jsp?jobid=job_201604121939_0004
Kill Command = /home/hadoop/hadoop/bin/../bin/hadoop job  -Dmapred.job.tracker=belona.c3local:9001 -kill job_201604121939_0004
2016-04-12 19:57:31,858 Stage-3 map = 0%,  reduce = 0%
2016-04-12 19:57:34,871 Stage-3 map = 100%,  reduce = 0%
2016-04-12 19:57:43,906 Stage-3 map = 100%,  reduce = 100%
Ended Job = job_201604121939_0004
Loading data to table q17_small_quantity_order_revenue
1 Rows loaded to q17_small_quantity_order_revenue
OK
Time taken: 570.555 seconds
